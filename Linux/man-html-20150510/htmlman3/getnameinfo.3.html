<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>getnameinfo(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="getnameinfo(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="getnameinfo.3" name="getnameinfo.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>getnameinfo — address-to-name translation in
      protocol-independent manner</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;sys/socket.h&gt;
#include &lt;netdb.h&gt;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>getnameinfo</strong>(</code></td>

            <td rowspan="1" colspan="1">const struct sockaddr *<var class="pdparam">sa</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">socklen_t <var class="pdparam">salen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">host</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">socklen_t <var class="pdparam">hostlen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">serv</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">socklen_t <var class="pdparam">servlen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">flags</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">getnameinfo</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 1 || <code class="constant">_XOPEN_SOURCE</code> ||
                      <code class="constant">_POSIX_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect1" name="getnameinfo-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">getnameinfo</code>() function
      is the inverse of <a class="link" href="../htmlman3/getaddrinfo.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getaddrinfo</span>(3)</span></a>: it converts
      a socket address to a corresponding host and service, in a
      protocol-independent manner. It combines the functionality of
      <a class="link" href="../htmlman3/gethostbyname.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">gethostbyaddr</span>(3)</span></a> and
      <a class="link" href="../htmlman3/getservent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getservbyport</span>(3)</span></a>, but
      unlike those functions, <code class="function">getnameinfo</code>() is reentrant and allows
      programs to eliminate IPv4-versus-IPv6 dependencies.</p>

      <p>The <em class="parameter"><code>sa</code></em> argument is
      a pointer to a generic socket address structure (of type
      <span class="structname">sockaddr_in</span> or <span class="structname">sockaddr_in6</span>) of size <em class="parameter"><code>salen</code></em> that holds the input IP
      address and port number. The arguments <em class="parameter"><code>host</code></em> and <em class="parameter"><code>serv</code></em> are pointers to
      caller-allocated buffers (of size <em class="parameter"><code>hostlen</code></em> and <em class="parameter"><code>servlen</code></em> respectively) into
      which <code class="function">getnameinfo</code>() places
      null-terminated strings containing the host and service names
      respectively.</p>

      <p>The caller can specify that no hostname (or no service
      name) is required by providing a NULL <em class="parameter"><code>host</code></em> (or <em class="parameter"><code>serv</code></em>) argument or a zero
      <em class="parameter"><code>hostlen</code></em> (or
      <em class="parameter"><code>servlen</code></em>) argument.
      However, at least one of hostname or service name must be
      requested.</p>

      <p>The <em class="parameter"><code>flags</code></em> argument
      modifies the behavior of <code class="function">getnameinfo</code>() as follows:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">NI_NAMEREQD</code></span></dt>

          <dd>
            <p>If set, then an error is returned if the hostname
            cannot be determined.</p>
          </dd>

          <dt><span class="term"><code class="constant">NI_DGRAM</code></span></dt>

          <dd>
            <p>If set, then the service is datagram (UDP) based
            rather than stream (TCP) based. This is required for
            the few ports (512-514) that have different services
            for UDP and TCP.</p>
          </dd>

          <dt><span class="term"><code class="constant">NI_NOFQDN</code></span></dt>

          <dd>
            <p>If set, return only the hostname part of the fully
            qualified domain name for local hosts.</p>
          </dd>

          <dt><span class="term"><code class="constant">NI_NUMERICHOST</code></span></dt>

          <dd>
            <p>If set, then the numeric form of the hostname is
            returned. (When not set, this will still happen in case
            the node's name cannot be determined.)</p>
          </dd>

          <dt><span class="term"><code class="constant">NI_NUMERICSERV</code></span></dt>

          <dd>
            <p>If set, then the numeric form of the service address
            is returned. (When not set, this will still happen in
            case the service's name cannot be determined.)</p>
          </dd>
        </dl>
      </div>

      <div class="refsect2">
        <a id="getnameinfo-3_sect2" name="getnameinfo-3_sect2" shape="rect"> </a>

        <h3>Extensions to getnameinfo() for Internationalized
        Domain Names</h3>

        <p>Starting with glibc 2.3.4, <code class="function">getnameinfo</code>() has been extended to
        selectively allow hostnames to be transparently converted
        to and from the Internationalized Domain Name (IDN) format
        (see RFC 3490, <span class="emphasis"><em>Internationalizing Domain Names in
        Applications (IDNA)</em></span>). Three new flags are
        defined:</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><code class="constant">NI_IDN</code></span></dt>

            <dd>
              <p>If this flag is used, then the name found in the
              lookup process is converted from IDN format to the
              locale's encoding if necessary. ASCII-only names are
              not affected by the conversion, which makes this flag
              usable in existing programs and environments.</p>
            </dd>

            <dt><span class="term"><code class="constant">NI_IDN_ALLOW_UNASSIGNED</code>, <code class="constant">NI_IDN_USE_STD3_ASCII_RULES</code></span></dt>

            <dd>
              <p>Setting these flags will enable the
              IDNA_ALLOW_UNASSIGNED (allow unassigned Unicode code
              points) and IDNA_USE_STD3_ASCII_RULES (check output
              to make sure it is a STD3 conforming hostname) flags
              respectively to be used in the IDNA handling.</p>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect3" name="getnameinfo-3_sect3" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, 0 is returned, and node and service names, if
      requested, are filled with null-terminated strings, possibly
      truncated to fit the specified buffer lengths. On error, one
      of the following nonzero error codes is returned:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">EAI_AGAIN</code></span></dt>

          <dd>
            <p>The name could not be resolved at this time. Try
            again later.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_BADFLAGS</code></span></dt>

          <dd>
            <p>The <em class="parameter"><code>flags</code></em>
            argument has an invalid value.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_FAIL</code></span></dt>

          <dd>
            <p>A nonrecoverable error occurred.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_FAMILY</code></span></dt>

          <dd>
            <p>The address family was not recognized, or the
            address length was invalid for the specified
            family.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_MEMORY</code></span></dt>

          <dd>
            <p>Out of memory.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_NONAME</code></span></dt>

          <dd>
            <p>The name does not resolve for the supplied
            arguments. <code class="constant">NI_NAMEREQD</code> is
            set and the host's name cannot be located, or neither
            hostname nor service name were requested.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_OVERFLOW</code></span></dt>

          <dd>
            <p>The buffer pointed to by <em class="parameter"><code>host</code></em> or <em class="parameter"><code>serv</code></em> was too small.</p>
          </dd>

          <dt><span class="term"><code class="constant">EAI_SYSTEM</code></span></dt>

          <dd>
            <p>A system error occurred. The error code can be found
            in <code class="varname">errno</code>.</p>
          </dd>
        </dl>
      </div>

      <p>The <a class="link" href="../htmlman3/getaddrinfo.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">gai_strerror</span>(3)</span></a> function
      translates these error codes to a human readable string,
      suitable for error reporting.</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect4" name="getnameinfo-3_sect4" shape="rect"> </a>

      <h2>FILES</h2>

      <p>/etc/hosts</p>

      <p>/etc/nsswitch.conf</p>

      <p>/etc/resolv.conf</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect5" name="getnameinfo-3_sect5" shape="rect"> </a>

      <h2>VERSIONS</h2>

      <p><code class="function">getnameinfo</code>() is provided in
      glibc since version 2.1.</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect6" name="getnameinfo-3_sect6" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>RFC 2553, POSIX.1-2001.</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect7" name="getnameinfo-3_sect7" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>In order to assist the programmer in choosing reasonable
      sizes for the supplied buffers, <code class="literal">&lt;</code><code class="filename">netdb.h</code><code class="literal">&gt;</code>
      defines the constants</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
#define NI_MAXHOST      1025
#define NI_MAXSERV      32
</pre>
          </div>
        </blockquote>
      </div>

      <p>Since glibc 2.8, these definitions are exposed only if one
      of the feature test macros <code class="constant">_BSD_SOURCE</code>, <code class="constant">_SVID_SOURCE</code>, or <code class="constant">_GNU_SOURCE</code> is defined.</p>

      <p>The former is the constant <code class="constant">MAXDNAME</code> in recent versions of BIND's
      <code class="literal">&lt;</code><code class="filename">arpa/nameser.h</code><code class="literal">&gt;</code> header file. The latter is a guess
      based on the services listed in the current Assigned Numbers
      RFC.</p>

      <p>Before glibc version 2.2, the <em class="parameter"><code>hostlen</code></em> and <em class="parameter"><code>servlen</code></em> arguments were typed as
      <span class="type">size_t</span>.</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect8" name="getnameinfo-3_sect8" shape="rect"> </a>

      <h2>EXAMPLE</h2>

      <p>The following code tries to get the numeric hostname and
      service name, for a given socket address. Note that there is
      no hardcoded reference to a particular address family.</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
struct sockaddr *sa;    /* input */
socklen_t len;         /* input */
char hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];

if (getnameinfo(sa, len, hbuf, sizeof(hbuf), sbuf,
            sizeof(sbuf), NI_NUMERICHOST | NI_NUMERICSERV) == 0)
    printf("host=%s, serv=%s\n", hbuf, sbuf);
</pre>
          </div>
        </blockquote>
      </div>

      <p>The following version checks if the socket address has a
      reverse address mapping.</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
struct sockaddr *sa;    /* input */
socklen_t len;         /* input */
char hbuf[NI_MAXHOST];

if (getnameinfo(sa, len, hbuf, sizeof(hbuf),
            NULL, 0, NI_NAMEREQD))
    printf("could not resolve hostname");
else
    printf("host=%s\n", hbuf);
</pre>
          </div>
        </blockquote>
      </div>

      <p>An example program using <code class="function">getnameinfo</code>() can be found in <a class="link" href="../htmlman3/getaddrinfo.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getaddrinfo</span>(3)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="getnameinfo-3_sect9" name="getnameinfo-3_sect9" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>, <a class="link" href="../htmlman2/getpeername.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpeername</span>(2)</span></a>, <a class="link" href="../htmlman2/getsockname.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getsockname</span>(2)</span></a>, <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvfrom</span>(2)</span></a>, <a class="link" href="../htmlman2/socket.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(2)</span></a>, <a class="link" href="../htmlman3/getaddrinfo.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getaddrinfo</span>(3)</span></a>, <a class="link" href="../htmlman3/gethostbyname.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">gethostbyaddr</span>(3)</span></a>, <a class="link" href="../htmlman3/getservent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getservbyname</span>(3)</span></a>, <a class="link" href="../htmlman3/getservent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getservbyport</span>(3)</span></a>, <a class="link" href="../htmlman3/inet_ntop.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">inet_ntop</span>(3)</span></a>, <a class="link" href="../htmlman5/hosts.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hosts</span>(5)</span></a>, <a class="link" href="../htmlman5/services.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">services</span>(5)</span></a>, <a class="link" href="../htmlman7/hostname.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hostname</span>(7)</span></a>, <span class="citerefentry"><span class="refentrytitle">named</span>(8)</span></p>

      <p>R. Gilligan, S. Thomson, J. Bound and W. Stevens,
      <span class="emphasis"><em>Basic Socket Interface Extensions
      for IPv6</em></span>, RFC 2553, March 1999.</p>

      <p>Tatsuya Jinmei and Atsushi Onoe, <span class="emphasis"><em>An Extension of Format for IPv6 Scoped
      Addresses</em></span>, internet draft, work in progress
      <a class="literalurl" href="ftp://ftp.ietf.org/internet/-drafts/draft/-ietf/-ipngwg/-scopedaddr/-format/-02.txt" target="_top" shape="rect">ftp://ftp.ietf.org/internet\-drafts/draft\-ietf\-ipngwg\-scopedaddr\-format\-02.txt</a></p>

      <p>Craig Metz, <span class="emphasis"><em>Protocol
      Independence Using the Sockets API</em></span>, Proceedings
      of the freenix track: 2000 USENIX annual technical
      conference, June 2000 <a class="literalurl" href="http://www.usenix.org/publications/library/proceedings/usenix2000/freenix/metzprotocol.html" target="_top" shape="rect">http://www.usenix.org/publications/library/proceedings/usenix2000/freenix/metzprotocol.html</a></p>
    </div>

    <div class="colophon">
      <a id="getnameinfo-3_sect10" name="getnameinfo-3_sect10" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    %%%LICENSE_START(PUBLIC_DOMAIN)<br />
                  This page is in the public domain.<br />

                  %%%LICENSE_END<br />
                  <br />
                  Almost all details are from RFC 2553.<br />

                  <br />
                  2004-12-14, mtk, Added EAI_OVERFLOW error<br />

                  2004-12-14 Fixed description of error return<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
