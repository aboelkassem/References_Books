<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>lber_sockbuf(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="lber_sockbuf(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="lber-sockbuf.3" name="lber-sockbuf.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>ber_sockbuf_alloc, ber_sockbuf_free, ber_sockbuf_ctrl,
      ber_sockbuf_add_io, ber_sockbuf_remove_io, Sockbuf_IO —
      OpenLDAP LBER I/O infrastructure</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;lber.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">Sockbuf
            *<strong>ber_sockbuf_alloc</strong>(</code></td>

            <td rowspan="1" colspan="1"><code>void)</code>;</td>

            <td rowspan="1" colspan="1"> </td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>ber_sockbuf_free</strong>(</code></td>

            <td rowspan="1" colspan="1">Sockbuf *<var class="pdparam">sb</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>ber_sockbuf_ctrl</strong>(</code></td>

            <td rowspan="1" colspan="1">Sockbuf *<var class="pdparam">sb</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">opt</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">void *<var class="pdparam">arg</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>ber_sockbuf_add_io</strong>(</code></td>

            <td rowspan="1" colspan="1">Sockbuf *<var class="pdparam">sb</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">Sockbuf_IO *<var class="pdparam">sbio</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">layer</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">void *<var class="pdparam">arg</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>ber_sockbuf_remove_io</strong>(</code></td>

            <td rowspan="1" colspan="1">Sockbuf *<var class="pdparam">sb</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">Sockbuf_IO *<var class="pdparam">sbio</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">layer</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="structdef">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col class="c1" span="1" />
            <col class="c2" span="1" />
            <col class="c3" span="1" />
            <col class="c4" span="1" />
            <col class="c5" span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
              typedef</td>

              <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1">struct <span class="structname">sockbuf_io_desc</span> {</td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
               </td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbiod_level</code></em>;</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">Sockbuf</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbiod_sb</code></em>;</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">Sockbuf_IO</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbiod_io</code></em>;</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">void</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbiod_pvt</code></em>;</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct sockbuf_io_desc</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbiod_next</code></em>;</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">} Sockbuf_IO_Desc;</td>
            </tr>

            <tr>
              <td class="structsep" style="" colspan="5" align="left" rowspan="1"></td>
            </tr>

            <tr>
              <td class="structdefhdr2" style="" align="left" rowspan="1" colspan="1">
              typedef</td>

              <td class="structdefhdr2" style="" colspan="4" align="left" rowspan="1">struct <span class="structname">sockbuf_io</span> {</td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_setup</code></em>)(Sockbuf_IO_Desc *sbiod, void *arg);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_remove</code></em>)(Sockbuf_IO_Desc *sbiod);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_ctrl</code></em>)(Sockbuf_IO_Desc *sbiod, int opt, void *arg);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">ber_slen_t</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_read</code></em>)(Sockbuf_IO_Desc *sbiod, void *buf, ber_len_t len);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">ber_slen_t</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_write</code></em>)(Sockbuf_IO_Desc *sbiod, void *buf, ber_len_t len);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td style="" rowspan="1" colspan="1"> </td>

              <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>

              <td class="norightpad" style="" align="right" rowspan="1" colspan="1">(*</td>

              <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sbi_close</code></em>)(Sockbuf_IO_Desc *sbiod);</td>

              <td style="" align="left" rowspan="1" colspan="1"> </td>
            </tr>

            <tr>
              <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">} Sockbuf_IO;</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="lber-sockbuf-3_sect1" name="lber-sockbuf-3_sect1" shape="rect"> </a>

      <h2>LIBRARY</h2>

      <p>OpenLDAP LBER (liblber, −llber)</p>
    </div>

    <div class="refsect1">
      <a id="lber-sockbuf-3_sect2" name="lber-sockbuf-3_sect2" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>These routines are used to manage the low level I/O
      operations performed by the Lightweight BER library. They are
      called implicitly by the other libraries and usually do not
      need to be called directly from applications. The I/O
      framework is modularized and new transport layers can be
      supported by appropriately defining a <span class="structname">Sockbuf_IO</span> structure and installing it
      onto an existing <span class="structname">Sockbuf</span>.
      <span class="structname">Sockbuf</span> structures are
      allocated and freed by <code class="function">ber_sockbuf_alloc</code>() and <code class="function">ber_sockbuf_free</code>(), respectively. The
      <code class="function">ber_sockbuf_ctrl</code>() function is
      used to get and set options related to a <span class="structname">Sockbuf</span> or to a specific I/O layer of the
      <span class="structname">Sockbuf</span>. The <code class="function">ber_sockbuf_add_io</code>() and <code class="function">ber_sockbuf_remove_io</code>() functions are used
      to add and remove specific I/O layers on a <span class="structname">Sockbuf</span>.</p>

      <p>Options for <code class="function">ber_sockbuf_ctrl</code>() include:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">LBER_SB_OPT_HAS_IO</code></span></dt>

          <dd>
            <p>Takes a <span class="emphasis"><em>Sockbuf_IO
            *</em></span> argument and returns 1 if the given
            handler is installed on the <span class="structname">Sockbuf</span>, otherwise returns 0.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_GET_FD</code></span></dt>

          <dd>
            <p>Retrieves the file descriptor associated to the
            <span class="structname">Sockbuf</span>; <em class="parameter"><code>arg</code></em> must be a
            <span class="emphasis"><em>ber_socket_t *</em></span>.
            The return value will be 1 if a valid descriptor was
            present, −1 otherwise.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_SET_FD</code></span></dt>

          <dd>
            <p>Sets the file descriptor of the <span class="structname">Sockbuf</span> to the descriptor pointed
            to by <em class="parameter"><code>arg</code></em>;
            <em class="parameter"><code>arg</code></em> must be a
            <span class="emphasis"><em>ber_socket_t *</em></span>.
            The return value will always be 1.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_SET_NONBLOCK</code></span></dt>

          <dd>
            <p>Toggles the non-blocking state of the file
            descriptor associated to the <span class="structname">Sockbuf</span>. <em class="parameter"><code>arg</code></em> should be NULL to
            disable and non-NULL to enable the non-blocking state.
            The return value will be 1 for success, −1
            otherwise.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_DRAIN</code></span></dt>

          <dd>
            <p>Flush (read and discard) all available input on the
            <span class="structname">Sockbuf</span>. The return
            value will be 1.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_NEEDS_READ</code></span></dt>

          <dd>
            <p>Returns non-zero if input is waiting to be read.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_NEEDS_WRITE</code></span></dt>

          <dd>
            <p>Returns non-zero if the <span class="structname">Sockbuf</span> is ready to be written.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_GET_MAX_INCOMING</code></span></dt>

          <dd>
            <p>Returns the maximum allowed size of an incoming
            message; <em class="parameter"><code>arg</code></em>
            must be a <span class="emphasis"><em>ber_len_t
            *</em></span>. The return value will be 1.</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SB_OPT_SET_MAX_INCOMING</code></span></dt>

          <dd>
            <p>Sets the maximum allowed size of an incoming
            message; <em class="parameter"><code>arg</code></em>
            must be a <span class="emphasis"><em>ber_len_t
            *</em></span>. The return value will be 1.</p>

            <p>Options not in this list will be passed down to each
            <span class="structname">Sockbuf_IO</span> handler in
            turn until one of them processes it. If the option is
            not handled <code class="function">ber_sockbuf_ctrl</code>() will return 0.</p>

            <p>Multiple <span class="structname">Sockbuf_IO</span>
            handlers can be stacked in multiple layers to provide
            various functionality. Currently defined layers
            include</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SBIOD_LEVEL_PROVIDER</code></span></dt>

          <dd>
            <p>the lowest layer, talking directly to a network</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SBIOD_LEVEL_TRANSPORT</code></span></dt>

          <dd>
            <p>an intermediate layer</p>
          </dd>

          <dt><span class="term"><code class="constant">LBER_SBIOD_LEVEL_APPLICATION</code></span></dt>

          <dd>
            <p>a higher layer</p>
          </dd>
        </dl>
      </div>

      <p>Currently defined <span class="structname">Sockbuf_IO</span> handlers in liblber
      include</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="function">ber_sockbuf_io_tcp</code></span></dt>

          <dd>
            <p>The default stream-oriented provider</p>
          </dd>

          <dt><span class="term"><code class="function">ber_sockbuf_io_fd</code></span></dt>

          <dd>
            <p>A stream-oriented provider for local IPC sockets</p>
          </dd>

          <dt><span class="term"><code class="function">ber_sockbuf_io_dgram</code></span></dt>

          <dd>
            <p>A datagram-oriented provider. This handler is only
            present if the liblber library was built with
            LDAP_CONNECTIONLESS defined.</p>
          </dd>

          <dt><span class="term"><code class="function">ber_sockbuf_io_readahead</code></span></dt>

          <dd>
            <p>A buffering layer, usually used with a datagram
            provider to hide the datagram semantics from upper
            layers.</p>
          </dd>

          <dt><span class="term"><code class="function">ber_sockbuf_io_debug</code></span></dt>

          <dd>
            <p>A generic handler that outputs hex dumps of all
            traffic. This handler may be inserted multiple times at
            arbitrary layers to show the flow of data between other
            handlers.</p>
          </dd>
        </dl>
      </div>

      <p>Additional handlers may be present in libldap if support
      for them was enabled:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="function">ldap_pvt_sockbuf_io_sasl</code></span></dt>

          <dd>
            <p>An application layer handler for SASL
            encoding/decoding.</p>
          </dd>

          <dt><span class="term"><code class="function">sb_tls_sbio</code></span></dt>

          <dd>
            <p>A transport layer handler for SSL/TLS
            encoding/decoding. Note that this handler is private to
            the library and is not exposed in the API.</p>
          </dd>
        </dl>
      </div>

      <p>The provided handlers are all instantiated implicitly by
      libldap, and applications generally will not need to directly
      manipulate them.</p>
    </div>

    <div class="refsect1">
      <a id="lber-sockbuf-3_sect3" name="lber-sockbuf-3_sect3" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman3/lber-decode.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lber-decode</span>(3)</span></a>, <a class="link" href="../htmlman3/lber-encode.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lber-encode</span>(3)</span></a>, <a class="link" href="../htmlman3/lber-types.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lber-types</span>(3)</span></a>, <a class="link" href="../htmlman3/ldap_get_option.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ldap_get_option</span>(3)</span></a></p>
    </div>

    <div class="refsect1">
      <a id="lber-sockbuf-3_sect4" name="lber-sockbuf-3_sect4" shape="rect"> </a>

      <h2>ACKNOWLEDGEMENTS</h2>

      <p><span class="emphasis"><em>OpenLDAP Software</em></span>
      is developed and maintained by The OpenLDAP Project
      &lt;<a class="literalurl" href="http://www.openldap.org/" target="_top" shape="rect">http://www.openldap.org/</a>&gt;. <span class="emphasis"><em>OpenLDAP Software</em></span> is derived from
      University of Michigan LDAP 3.3 Release.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                  See the following documents: <a class="ulink" href="../openldap-COPYRIGHT.html" target="_top" shape="rect">COPYRIGHT</a>, <a class="ulink" href="../openldap-LICENSE.html" target="_top" shape="rect">LICENSE</a><br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
