<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>getpwent_r(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="getpwent_r(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="getpwent-r.3" name="getpwent-r.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>getpwent_r, fgetpwent_r — get passwd file entry
      reentrantly</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;pwd.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>getpwent_r</strong>(</code></td>

            <td rowspan="1" colspan="1">struct passwd *<var class="pdparam">pwbuf</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">buf</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">buflen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct passwd **<var class="pdparam">pwbufp</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>fgetpwent_r</strong>(</code></td>

            <td rowspan="1" colspan="1">FILE *<var class="pdparam">stream</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct passwd *<var class="pdparam">pwbuf</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">char *<var class="pdparam">buf</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">size_t <var class="pdparam">buflen</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct passwd **<var class="pdparam">pwbufp</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">getpwent_r</code>(), <code class="constant">_BSD_SOURCE</code> || <code class="constant">_SVID_SOURCE</code></td>
                    </tr>

                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">fgetpwent_r</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_SVID_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect1" name="getpwent-r-3_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The functions <code class="function">getpwent_r</code>()
      and <code class="function">fgetpwent_r</code>() are the
      reentrant versions of <a class="link" href="../htmlman3/getpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpwent</span>(3)</span></a> and <a class="link" href="../htmlman3/fgetpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fgetpwent</span>(3)</span></a>. The former
      reads the next passwd entry from the stream initialized by
      <a class="link" href="../htmlman3/getpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">setpwent</span>(3)</span></a>. The latter
      reads the next passwd entry from <em class="parameter"><code>stream</code></em>.</p>

      <p>The <span class="structname">passwd</span> structure is
      defined in <code class="literal">&lt;</code><code class="filename">pwd.h</code><code class="literal">&gt;</code> as
      follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">passwd</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_name</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* username */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_passwd</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* user password */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">uid_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_uid</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* user ID */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">gid_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_gid</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* group ID */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_gecos</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* user information */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_dir</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* home directory */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>pw_shell</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* shell program */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>For more information about the fields of this structure,
      see <a class="link" href="../htmlman5/passwd.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">passwd</span>(5)</span></a>.</p>

      <p>The nonreentrant functions return a pointer to static
      storage, where this static storage contains further pointers
      to user name, password, gecos field, home directory and
      shell. The reentrant functions described here return all of
      that in caller-provided buffers. First of all there is the
      buffer <em class="parameter"><code>pwbuf</code></em> that can
      hold a <span class="emphasis"><em>struct passwd</em></span>.
      And next the buffer <em class="parameter"><code>buf</code></em> of size <em class="parameter"><code>buflen</code></em> that can hold additional
      strings. The result of these functions, the <span class="emphasis"><em>struct passwd</em></span> read from the
      stream, is stored in the provided buffer *<em class="parameter"><code>pwbuf</code></em>, and a pointer to this
      <span class="emphasis"><em>struct passwd</em></span> is
      returned in *<em class="parameter"><code>pwbufp</code></em>.</p>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect2" name="getpwent-r-3_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, these functions return 0 and *<em class="parameter"><code>pwbufp</code></em> is a pointer to the
      <span class="emphasis"><em>struct passwd</em></span>. On
      error, these functions return an error value and *<em class="parameter"><code>pwbufp</code></em> is NULL.</p>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect3" name="getpwent-r-3_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">ENOENT</span></span></dt>

          <dd>
            <p>No more entries.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ERANGE</span></span></dt>

          <dd>
            <p>Insufficient buffer space supplied. Try again with
            larger buffer.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect4" name="getpwent-r-3_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>These functions are GNU extensions, done in a style
      resembling the POSIX version of functions like <a class="link" href="../htmlman3/getpwnam.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpwnam_r</span>(3)</span></a>. Other
      systems use the prototype</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
struct passwd *
getpwent_r(struct passwd *pwd, char *buf, int buflen);
</pre>
          </div>
        </blockquote>
      </div>

      <p>or, better,</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
int
getpwent_r(struct passwd *pwd, char *buf, int buflen,
           FILE **pw_fp);
</pre>
          </div>
        </blockquote>
      </div>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect5" name="getpwent-r-3_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>The function <code class="function">getpwent_r</code>() is
      not really reentrant since it shares the reading position in
      the stream with all other threads.</p>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect6" name="getpwent-r-3_sect6" shape="rect"> </a>

      <h2>EXAMPLE</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#define _GNU_SOURCE
#include &lt;pwd.h&gt;
#include &lt;stdio.h&gt;
#define BUFLEN 4096

int
main(void)
{
    struct passwd pw, *pwp;
    char buf[BUFLEN];
    int i;

    setpwent();
    while (1) {
        i = getpwent_r(&amp;pw, buf, BUFLEN, &amp;pwp);
        if (i)
            break;
        printf("%s (%d)\tHOME %s\tSHELL %s\n", pwp−&gt;pw_name,
               pwp−&gt;pw_uid, pwp−&gt;pw_dir, pwp−&gt;pw_shell);
    }
    endpwent();
    exit(EXIT_SUCCESS);
}
</pre>
      </div>
    </div>

    <div class="refsect1">
      <a id="getpwent-r-3_sect7" name="getpwent-r-3_sect7" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman3/fgetpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fgetpwent</span>(3)</span></a>, <a class="link" href="../htmlman3/getpw.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpw</span>(3)</span></a>, <a class="link" href="../htmlman3/getpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpwent</span>(3)</span></a>, <a class="link" href="../htmlman3/getpwnam.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpwnam</span>(3)</span></a>, <a class="link" href="../htmlman3/getpwnam.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getpwuid</span>(3)</span></a>, <a class="link" href="../htmlman3/putpwent.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">putpwent</span>(3)</span></a>, <a class="link" href="../htmlman5/passwd.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">passwd</span>(5)</span></a></p>
    </div>

    <div class="colophon">
      <a id="getpwent-r-3_sect8" name="getpwent-r-3_sect8" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 2003 Andries Brouwer (aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl)<br />

                  <br />
                  %%%LICENSE_START(GPLv2+_DOC_FULL)<br />
                  This is free documentation; you can redistribute it and/or<br />

                  modify it under the terms of the GNU General Public License as<br />

                  published by the Free Software Foundation; either version 2 of<br />

                  the License, or (at your option) any later version.<br />

                  <br />
                  The GNU General Public License's references to "object code"<br />

                  and "executables" are to be interpreted as the output of any<br />

                  document formatting or typesetting system, including<br />

                  intermediate and printed output.<br />

                  <br />
                  This manual is distributed in the hope that it will be useful,<br />

                  but WITHOUT ANY WARRANTY; without even the implied warranty of<br />

                  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br />

                  GNU General Public License for more details.<br />

                  <br />
                  You should have received a copy of the GNU General Public<br />

                  License along with this manual; if not, see<br />

                  &lt;<a class="literalurl" href="http://www.gnu.org/licenses/" target="_top" shape="rect">http://www.gnu.org/licenses/</a>&gt;.<br />

                  %%%LICENSE_END<br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
