<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>truncate(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="truncate(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="truncate.2" name="truncate.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>truncate, ftruncate — truncate a file to a specified
      length</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>truncate</strong>(</code></td>

            <td rowspan="1" colspan="1">const char *<var class="pdparam">path</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">off_t <var class="pdparam">length</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>ftruncate</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">off_t <var class="pdparam">length</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">truncate</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_BSD_SOURCE</code> ||
                      <code class="constant">_XOPEN_SOURCE</code>
                      &gt;= 500 || <code class="constant">_XOPEN_SOURCE</code> &amp;&amp;
                      <code class="constant">_XOPEN_SOURCE_EXTENDED</code></td>
                    </tr>

                    <tr>
                      <td class="featuretestver" style="" rowspan="1" colspan="1">|| /*
                      Since glibc 2.12: */</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 200809L</td>
                    </tr>

                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">ftruncate</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_BSD_SOURCE</code> ||
                      <code class="constant">_XOPEN_SOURCE</code>
                      &gt;= 500 || <code class="constant">_XOPEN_SOURCE</code> &amp;&amp;
                      <code class="constant">_XOPEN_SOURCE_EXTENDED</code></td>
                    </tr>

                    <tr>
                      <td class="featuretestver" style="" rowspan="1" colspan="1">|| /*
                      Since glibc 2.3.5: */</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 200112L</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect1" name="truncate-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <code class="function">truncate</code>() and
      <code class="function">ftruncate</code>() functions cause the
      regular file named by <em class="parameter"><code>path</code></em> or referenced by
      <em class="parameter"><code>fd</code></em> to be truncated to
      a size of precisely <em class="parameter"><code>length</code></em> bytes.</p>

      <p>If the file previously was larger than this size, the
      extra data is lost. If the file previously was shorter, it is
      extended, and the extended part reads as null bytes
      ('\0').</p>

      <p>The file offset is not changed.</p>

      <p>If the size changed, then the st_ctime and st_mtime fields
      (respectively, time of last status change and time of last
      modification; see <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a>) for the file are
      updated, and the set-user-ID and set-group-ID mode bits may
      be cleared.</p>

      <p>With <code class="function">ftruncate</code>(), the file
      must be open for writing; with <code class="function">truncate</code>(), the file must be writable.</p>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect2" name="truncate-2_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, zero is returned. On error, −1 is
      returned, and <code class="varname">errno</code> is set
      appropriately.</p>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect3" name="truncate-2_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <p>For <code class="function">truncate</code>():</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EACCES</span></span></dt>

          <dd>
            <p>Search permission is denied for a component of the
            path prefix, or the named file is not writable by the
            user. (See also <a class="link" href="../htmlman7/path_resolution.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">path_resolution</span>(7)</span></a>.)</p>
          </dd>

          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>

          <dd>
            <p>The argument <em class="parameter"><code>path</code></em> points outside the
            process's allocated address space.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EFBIG</span></span></dt>

          <dd>
            <p>The argument <em class="parameter"><code>length</code></em> is larger than the
            maximum file size. (XSI)</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINTR</span></span></dt>

          <dd>
            <p>While blocked waiting to complete, the call was
            interrupted by a signal handler; see <a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a> and
            <a class="link" href="../htmlman7/signal.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">signal</span>(7)</span></a>.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>The argument <em class="parameter"><code>length</code></em> is negative or
            larger than the maximum file size.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EIO</span></span></dt>

          <dd>
            <p>An I/O error occurred updating the inode.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EISDIR</span></span></dt>

          <dd>
            <p>The named file is a directory.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ELOOP</span></span></dt>

          <dd>
            <p>Too many symbolic links were encountered in
            translating the pathname.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENAMETOOLONG</span></span></dt>

          <dd>
            <p>A component of a pathname exceeded 255 characters,
            or an entire pathname exceeded 1023 characters.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENOENT</span></span></dt>

          <dd>
            <p>The named file does not exist.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENOTDIR</span></span></dt>

          <dd>
            <p>A component of the path prefix is not a
            directory.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EPERM</span></span></dt>

          <dd>
            <p>The underlying filesystem does not support extending
            a file beyond its current size.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EPERM</span></span></dt>

          <dd>
            <p>The operation was prevented by a file seal; see
            <a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a>.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EROFS</span></span></dt>

          <dd>
            <p>The named file resides on a read-only
            filesystem.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ETXTBSY</span></span></dt>

          <dd>
            <p>The file is a pure procedure (shared text) file that
            is being executed.</p>
          </dd>
        </dl>
      </div>

      <p>For <code class="function">ftruncate</code>() the same
      errors apply, but instead of things that can be wrong with
      <em class="parameter"><code>path</code></em>, we now have
      things that can be wrong with the file descriptor, <em class="parameter"><code>fd</code></em>:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>

          <dd>
            <p><em class="parameter"><code>fd</code></em> is not a
            valid descriptor.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EBADF</span> or <span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p><em class="parameter"><code>fd</code></em> is not
            open for writing.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p><em class="parameter"><code>fd</code></em> does not
            reference a regular file.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect4" name="truncate-2_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>4.4BSD, SVr4, POSIX.1-2001 (these calls first appeared in
      4.2BSD).</p>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect5" name="truncate-2_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>The details in DESCRIPTION are for XSI-compliant systems.
      For non-XSI-compliant systems, the POSIX standard allows two
      behaviors for <code class="function">ftruncate</code>() when
      <em class="parameter"><code>length</code></em> exceeds the
      file length (note that <code class="function">truncate</code>() is not specified at all in such
      an environment): either returning an error, or extending the
      file. Like most UNIX implementations, Linux follows the XSI
      requirement when dealing with native filesystems. However,
      some nonnative filesystems do not permit <code class="function">truncate</code>() and <code class="function">ftruncate</code>() to be used to extend a file
      beyond its current length: a notable example on Linux is
      VFAT.</p>

      <p>The original Linux <code class="function">truncate</code>() and <code class="function">ftruncate</code>() system calls were not designed
      to handle large file offsets. Consequently, Linux 2.4 added
      <code class="function">truncate64</code>() and <code class="function">ftruncate64</code>() system calls that handle
      large files. However, these details can be ignored by
      applications using glibc, whose wrapper functions
      transparently employ the more recent system calls where they
      are available.</p>

      <p>On some 32-bit architectures, the calling signature for
      these system calls differ, for the reasons described in
      <a class="link" href="../htmlman2/syscall.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">syscall</span>(2)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect6" name="truncate-2_sect6" shape="rect"> </a>

      <h2>BUGS</h2>

      <p>A header file bug in glibc 2.12 meant that the minimum
      value of <code class="constant">_POSIX_C_SOURCE</code>
      required to expose the declaration of <code class="function">ftruncate</code>() was 200809L instead of 200112L.
      This has been fixed in later glibc versions.</p>
    </div>

    <div class="refsect1">
      <a id="truncate-2_sect7" name="truncate-2_sect7" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>, <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a>, <a class="link" href="../htmlman7/path_resolution.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">path_resolution</span>(7)</span></a></p>
    </div>

    <div class="colophon">
      <a id="truncate-2_sect8" name="truncate-2_sect8" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1983, 1991 The Regents of the University of California.<br />

                  All rights reserved.<br />
                  <br />
                  %%%LICENSE_START(BSD_4_CLAUSE_UCB)<br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  %%%LICENSE_END<br />
                  <br />
                      <script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>(#)truncate.2
                  6.9 (Berkeley) 3/10/91<br />
                  <br />
                  Modified 1993-07-24 by Rik Faith &lt;faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu&gt;<br />

                  Modified 1996-10-22 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified 1998-12-21 by Andries Brouwer &lt;aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl&gt;<br />

                  Modified 2002-01-07 by Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  Modified 2002-04-06 by Andries Brouwer &lt;aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl&gt;<br />

                  Modified 2004-06-23 by Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
