<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>listen(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="listen(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="listen.2" name="listen.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>listen — listen for connections on a socket</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;sys/types.h&gt;           /* See NOTES */
#include &lt;sys/socket.h&gt;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>listen</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">sockfd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">backlog</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect1" name="listen-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p><code class="function">listen</code>() marks the socket
      referred to by <em class="parameter"><code>sockfd</code></em>
      as a passive socket, that is, as a socket that will be used
      to accept incoming connection requests using <a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p>

      <p>The <em class="parameter"><code>sockfd</code></em>
      argument is a file descriptor that refers to a socket of type
      <code class="constant">SOCK_STREAM</code> or <code class="constant">SOCK_SEQPACKET</code>.</p>

      <p>The <em class="parameter"><code>backlog</code></em>
      argument defines the maximum length to which the queue of
      pending connections for <em class="parameter"><code>sockfd</code></em> may grow. If a
      connection request arrives when the queue is full, the client
      may receive an error with an indication of <span class="errorname">ECONNREFUSED</span> or, if the underlying
      protocol supports retransmission, the request may be ignored
      so that a later reattempt at connection succeeds.</p>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect2" name="listen-2_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, zero is returned. On error, −1 is
      returned, and <code class="varname">errno</code> is set
      appropriately.</p>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect3" name="listen-2_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EADDRINUSE</span></span></dt>

          <dd>
            <p>Another socket is already listening on the same
            port.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EADDRINUSE</span></span></dt>

          <dd>
            <p>(Internet domain sockets) The socket referred to by
            <em class="parameter"><code>sockfd</code></em> had not
            previously been bound to an address and, upon
            attempting to bind it to an ephemeral port, it was
            determined that all port numbers in the ephemeral port
            range are currently in use. See the discussion of
            <code class="filename">/proc/sys/net/ipv4/ip_local_port_range</code>
            in <a class="link" href="../htmlman7/ip.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ip</span>(7)</span></a>.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>

          <dd>
            <p>The argument <em class="parameter"><code>sockfd</code></em> is not a valid
            descriptor.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENOTSOCK</span></span></dt>

          <dd>
            <p>The argument <em class="parameter"><code>sockfd</code></em> is not a
            socket.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EOPNOTSUPP</span></span></dt>

          <dd>
            <p>The socket is not of a type that supports the
            <code class="function">listen</code>() operation.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect4" name="listen-2_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>4.4BSD, POSIX.1-2001. The <code class="function">listen</code>() function call first appeared in
      4.2BSD.</p>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect5" name="listen-2_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>To accept connections, the following steps are
      performed:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="orderedlist">
            <ol class="orderedlist" type="1">
              <li class="listitem">
                <p>A socket is created with <a class="link" href="../htmlman2/socket.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(2)</span></a>.</p>
              </li>

              <li class="listitem">
                <p>The socket is bound to a local address using
                <a class="link" href="../htmlman2/bind.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">bind</span>(2)</span></a>, so that
                other sockets may be <a class="link" href="../htmlman2/connect.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a>ed to
                it.</p>
              </li>

              <li class="listitem">
                <p>A willingness to accept incoming connections and
                a queue limit for incoming connections are
                specified with <code class="function">listen</code>().</p>
              </li>

              <li class="listitem">
                <p>Connections are accepted with <a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p>
              </li>
            </ol>
          </div>
        </blockquote>
      </div>

      <p>POSIX.1-2001 does not require the inclusion of
      <code class="literal">&lt;</code><code class="filename">sys/types.h</code><code class="literal">&gt;</code> and this header file is not required on
      Linux. However, some historical (BSD) implementations
      required this header file, and portable applications are
      probably wise to include it.</p>

      <p>The behavior of the <em class="parameter"><code>backlog</code></em> argument on TCP sockets
      changed with Linux 2.2. Now it specifies the queue length for
      <em class="replaceable"><code>completely</code></em>
      established sockets waiting to be accepted, instead of the
      number of incomplete connection requests. The maximum length
      of the queue for incomplete sockets can be set using
      <code class="filename">/proc/sys/net/ipv4/tcp_max_syn_backlog</code>.
      When syncookies are enabled there is no logical maximum
      length and this setting is ignored. See <a class="link" href="../htmlman7/tcp.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">tcp</span>(7)</span></a> for more
      information.</p>

      <p>If the <em class="parameter"><code>backlog</code></em>
      argument is greater than the value in <code class="filename">/proc/sys/net/core/somaxconn</code>, then it is
      silently truncated to that value; the default value in this
      file is 128. In kernels before 2.4.25, this limit was a hard
      coded value, <code class="constant">SOMAXCONN</code>, with
      the value 128.</p>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect6" name="listen-2_sect6" shape="rect"> </a>

      <h2>EXAMPLE</h2>

      <p>See <a class="link" href="../htmlman2/bind.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">bind</span>(2)</span></a>.</p>
    </div>

    <div class="refsect1">
      <a id="listen-2_sect7" name="listen-2_sect7" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>, <a class="link" href="../htmlman2/bind.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">bind</span>(2)</span></a>, <a class="link" href="../htmlman2/connect.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a>, <a class="link" href="../htmlman2/socket.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(2)</span></a>, <a class="link" href="../htmlman7/socket.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(7)</span></a></p>
    </div>

    <div class="colophon">
      <a id="listen-2_sect8" name="listen-2_sect8" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.72 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1983, 1991 The Regents of the University of California.<br />

                  and Copyright (C) 2007, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  All rights reserved.<br />
                  <br />
                  %%%LICENSE_START(BSD_4_CLAUSE_UCB)<br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  %%%LICENSE_END<br />
                  <br />
                      $Id: listen.2,v 1.6 1999/05/18 14:10:32 freitag Exp $<br />

                  <br />
                  Modified Fri Jul 23 22:07:54 1993 by Rik Faith &lt;faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu&gt;<br />

                  Modified 950727 by aeb, following a suggestion by Urs Thuermann<br />

                  &lt;urs<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>isnogud.escape.de&gt;<br />
                  Modified Tue Oct 22 08:11:14 EDT 1996 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified 1998 by Andi Kleen<br />

                  Modified 11 May 2001 by Sam Varshavchik &lt;mrsam<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>courier-mta.com&gt;<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
