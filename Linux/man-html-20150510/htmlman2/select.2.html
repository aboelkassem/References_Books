<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>select(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="select(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="select.2" name="select.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>select, pselect, FD_CLR, FD_ISSET, FD_SET, FD_ZERO —
      synchronous I/O multiplexing</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
/* According to POSIX.1-2001 */
#include &lt;sys/select.h&gt;

/* According to earlier standards */
#include &lt;sys/time.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
</pre>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>select</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">nfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">readfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">writefds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">exceptfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct timeval *<var class="pdparam">timeout</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>FD_CLR</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">set</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>FD_ISSET</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">set</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>FD_SET</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">set</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>FD_ZERO</strong>(</code></td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">set</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;sys/select.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>pselect</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">nfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">readfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">writefds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">fd_set *<var class="pdparam">exceptfds</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const struct timespec *<var class="pdparam">timeout</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const sigset_t *<var class="pdparam">sigmask</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">pselect</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 200112L || <code class="constant">_XOPEN_SOURCE</code> &gt;=
                      600</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="select-2_sect1" name="select-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p><code class="function">select</code>() and <code class="function">pselect</code>() allow a program to monitor
      multiple file descriptors, waiting until one or more of the
      file descriptors become "ready" for some class of I/O
      operation (e.g., input possible). A file descriptor is
      considered ready if it is possible to perform a corresponding
      I/O operation (e.g., <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> without blocking,
      or a sufficiently small <a class="link" href="../htmlman2/write.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">write</span>(2)</span></a>).</p>

      <p>The operation of <code class="function">select</code>()
      and <code class="function">pselect</code>() is identical,
      other than these three differences:</p>

      <div class="orderedlist">
        <ol class="orderedlist" type="i">
          <li class="listitem">
            <p><code class="function">select</code>() uses a
            timeout that is a <span class="emphasis"><em>struct
            timeval</em></span> (with seconds and microseconds),
            while <code class="function">pselect</code>() uses a
            <span class="emphasis"><em>struct timespec</em></span>
            (with seconds and nanoseconds).</p>
          </li>

          <li class="listitem">
            <p><code class="function">select</code>() may update
            the <em class="parameter"><code>timeout</code></em>
            argument to indicate how much time was left.
            <code class="function">pselect</code>() does not change
            this argument.</p>
          </li>

          <li class="listitem">
            <p><code class="function">select</code>() has no
            <em class="parameter"><code>sigmask</code></em>
            argument, and behaves as <code class="function">pselect</code>() called with NULL <em class="parameter"><code>sigmask</code></em>.</p>
          </li>
        </ol>
      </div>

      <p>Three independent sets of file descriptors are watched.
      Those listed in <em class="parameter"><code>readfds</code></em> will be watched to see
      if characters become available for reading (more precisely,
      to see if a read will not block; in particular, a file
      descriptor is also ready on end-of-file), those in <em class="parameter"><code>writefds</code></em> will be watched to see
      if space is available for write (though a large write may
      still block), and those in <em class="parameter"><code>exceptfds</code></em> will be watched for
      exceptions. On exit, the sets are modified in place to
      indicate which file descriptors actually changed status. Each
      of the three file descriptor sets may be specified as NULL if
      no file descriptors are to be watched for the corresponding
      class of events.</p>

      <p>Four macros are provided to manipulate the sets.
      <code class="function">FD_ZERO</code>() clears a set.
      <code class="function">FD_SET</code>() and <code class="function">FD_CLR</code>() respectively add and remove a
      given file descriptor from a set. <code class="function">FD_ISSET</code>() tests to see if a file
      descriptor is part of the set; this is useful after
      <code class="function">select</code>() returns.</p>

      <p><em class="parameter"><code>nfds</code></em> is the
      highest-numbered file descriptor in any of the three sets,
      plus 1.</p>

      <p>The <em class="parameter"><code>timeout</code></em>
      argument specifies the interval that <code class="function">select</code>() should block waiting for a file
      descriptor to become ready. The call will block until
      either:</p>

      <div class="itemizedlist">
        <ul class="itemizedlist" style="list-style-type: disc;">
          <li class="listitem">
            <p>a file descriptor becomes ready;</p>
          </li>

          <li class="listitem">
            <p>the call is interrupted by a signal handler; or</p>
          </li>

          <li class="listitem">
            <p>the timeout expires.</p>
          </li>
        </ul>
      </div>

      <p>Note that the <em class="parameter"><code>timeout</code></em> interval will be
      rounded up to the system clock granularity, and kernel
      scheduling delays mean that the blocking interval may overrun
      by a small amount. If both fields of the <span class="structname">timeval</span> structure are zero, then
      <code class="function">select</code>() returns immediately.
      (This is useful for polling.) If <em class="parameter"><code>timeout</code></em> is NULL (no timeout),
      <code class="function">select</code>() can block
      indefinitely.</p>

      <p><em class="parameter"><code>sigmask</code></em> is a
      pointer to a signal mask (see <a class="link" href="../htmlman2/sigprocmask.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sigprocmask</span>(2)</span></a>); if it is
      not NULL, then <code class="function">pselect</code>() first
      replaces the current signal mask by the one pointed to by
      <em class="parameter"><code>sigmask</code></em>, then does
      the "select" function, and then restores the original signal
      mask.</p>

      <p>Other than the difference in the precision of the
      <em class="parameter"><code>timeout</code></em> argument, the
      following <code class="function">pselect</code>() call:</p>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
    ready = pselect(nfds, &amp;readfds, &amp;writefds, &amp;exceptfds,
                    timeout, &amp;sigmask);
</pre>
      </div>

      <p>is equivalent to <em class="replaceable"><code>atomically</code></em> executing the
      following calls:</p>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
    sigset_t origmask;

    pthread_sigmask(SIG_SETMASK, &amp;sigmask, &amp;origmask);
    ready = select(nfds, &amp;readfds, &amp;writefds, &amp;exceptfds, timeout);
    pthread_sigmask(SIG_SETMASK, &amp;origmask, NULL);
</pre>
      </div>

      <p>The reason that <code class="function">pselect</code>() is
      needed is that if one wants to wait for either a signal or
      for a file descriptor to become ready, then an atomic test is
      needed to prevent race conditions. (Suppose the signal
      handler sets a global flag and returns. Then a test of this
      global flag followed by a call of <code class="function">select</code>() could hang indefinitely if the
      signal arrived just after the test but just before the call.
      By contrast, <code class="function">pselect</code>() allows
      one to first block signals, handle the signals that have come
      in, then call <code class="function">pselect</code>() with
      the desired <em class="parameter"><code>sigmask</code></em>,
      avoiding the race.)</p>

      <div class="refsect2">
        <a id="select-2_sect2" name="select-2_sect2" shape="rect"> </a>

        <h3>The timeout</h3>

        <p>The time structures involved are defined in <code class="literal">&lt;</code><code class="filename">sys/time.h</code><code class="literal">&gt;</code> and look like</p>

        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>

                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>

                    <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">timeval</span> {</td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_sec</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* seconds */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_usec</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* microseconds */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>

        <p>and</p>

        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>

                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>

                    <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">timespec</span> {</td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_sec</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* seconds */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_nsec</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* nanoseconds */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>

        <p>(However, see below on the POSIX.1-2001 versions.)</p>

        <p>Some code calls <code class="function">select</code>()
        with all three sets empty, <em class="parameter"><code>nfds</code></em> zero, and a non-NULL
        <em class="parameter"><code>timeout</code></em> as a fairly
        portable way to sleep with subsecond precision.</p>

        <p>On Linux, <code class="function">select</code>()
        modifies <em class="parameter"><code>timeout</code></em> to
        reflect the amount of time not slept; most other
        implementations do not do this. (POSIX.1-2001 permits
        either behavior.) This causes problems both when Linux code
        which reads <em class="parameter"><code>timeout</code></em>
        is ported to other operating systems, and when code is
        ported to Linux that reuses a <span class="emphasis"><em>struct timeval</em></span> for multiple
        <code class="function">select</code>()s in a loop without
        reinitializing it. Consider <em class="parameter"><code>timeout</code></em> to be undefined after
        <code class="function">select</code>() returns.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="select-2_sect3" name="select-2_sect3" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On success, <code class="function">select</code>() and
      <code class="function">pselect</code>() return the number of
      file descriptors contained in the three returned descriptor
      sets (that is, the total number of bits that are set in
      <em class="parameter"><code>readfds</code></em>, <em class="parameter"><code>writefds</code></em>, <em class="parameter"><code>exceptfds</code></em>) which may be zero if
      the timeout expires before anything interesting happens. On
      error, −1 is returned, and <code class="varname">errno</code> is set to indicate the error; the file
      descriptor sets are unmodified, and <em class="parameter"><code>timeout</code></em> becomes undefined.</p>
    </div>

    <div class="refsect1">
      <a id="select-2_sect4" name="select-2_sect4" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>

          <dd>
            <p>An invalid file descriptor was given in one of the
            sets. (Perhaps a file descriptor that was already
            closed, or one on which an error has occurred.)</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINTR</span></span></dt>

          <dd>
            <p>A signal was caught; see <a class="link" href="../htmlman7/signal.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">signal</span>(7)</span></a>.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p><em class="parameter"><code>nfds</code></em> is
            negative or exceeds the <code class="constant">RLIMIT_NOFILE</code> resource limit (see
            <a class="link" href="../htmlman2/getrlimit.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getrlimit</span>(2)</span></a>).</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>the value contained within <em class="parameter"><code>timeout</code></em> is invalid.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENOMEM</span></span></dt>

          <dd>
            <p>unable to allocate memory for internal tables.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="select-2_sect5" name="select-2_sect5" shape="rect"> </a>

      <h2>VERSIONS</h2>

      <p><code class="function">pselect</code>() was added to Linux
      in kernel 2.6.16. Prior to this, <code class="function">pselect</code>() was emulated in glibc (but see
      BUGS).</p>
    </div>

    <div class="refsect1">
      <a id="select-2_sect6" name="select-2_sect6" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p><code class="function">select</code>() conforms to
      POSIX.1-2001 and 4.4BSD (<code class="function">select</code>() first appeared in 4.2BSD).
      Generally portable to/from non-BSD systems supporting clones
      of the BSD socket layer (including System V variants).
      However, note that the System V variant typically sets the
      timeout variable before exit, but the BSD variant does
      not.</p>

      <p><code class="function">pselect</code>() is defined in
      POSIX.1g, and in POSIX.1-2001.</p>
    </div>

    <div class="refsect1">
      <a id="select-2_sect7" name="select-2_sect7" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>An <em class="replaceable"><code>fd_set</code></em> is a
      fixed size buffer. Executing <code class="function">FD_CLR</code>() or <code class="function">FD_SET</code>() with a value of <em class="parameter"><code>fd</code></em> that is negative or is equal
      to or larger than <code class="constant">FD_SETSIZE</code>
      will result in undefined behavior. Moreover, POSIX requires
      <em class="parameter"><code>fd</code></em> to be a valid file
      descriptor.</p>

      <p>Concerning the types involved, the classical situation is
      that the two fields of a <span class="structname">timeval</span> structure are typed as
      <span class="type">long</span> (as shown above), and the
      structure is defined in <code class="literal">&lt;</code><code class="filename">sys/time.h</code><code class="literal">&gt;</code>
      The POSIX.1-2001 situation is</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">timeval</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">time_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_sec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* seconds */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">suseconds_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_usec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* microseconds */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>where the structure is defined in <code class="literal">&lt;</code><code class="filename">sys/select.h</code><code class="literal">&gt;</code> and the data types <span class="type">time_t</span> and <span class="type">suseconds_t</span> are defined in <code class="literal">&lt;</code><code class="filename">sys/types.h</code><code class="literal">&gt;</code></p>

      <p>Concerning prototypes, the classical situation is that one
      should include <code class="literal">&lt;</code><code class="filename">time.h</code><code class="literal">&gt;</code> for
      <code class="function">select</code>(). The POSIX.1-2001
      situation is that one should include <code class="literal">&lt;</code><code class="filename">sys/select.h</code><code class="literal">&gt;</code> for <code class="function">select</code>() and <code class="function">pselect</code>().</p>

      <p>Under glibc 2.0, <code class="literal">&lt;</code><code class="filename">sys/select.h</code><code class="literal">&gt;</code> gives the wrong prototype for
      <code class="function">pselect</code>(). Under glibc 2.1 to
      2.2.1, it gives <code class="function">pselect</code>() when
      <code class="constant">_GNU_SOURCE</code> is defined. Since
      glibc 2.2.2, the requirements are as shown in the
      SYNOPSIS.</p>

      <div class="refsect2">
        <a id="select-2_sect8" name="select-2_sect8" shape="rect"> </a>

        <h3>Multithreaded applications</h3>

        <p>If a file descriptor being monitored by <code class="function">select</code>() is closed in another thread, the
        result is unspecified. On some UNIX systems, <code class="function">select</code>() unblocks and returns, with an
        indication that the file descriptor is ready (a subsequent
        I/O operation will likely fail with an error, unless
        another the file descriptor reopened between the time
        <code class="function">select</code>() returned and the I/O
        operations was performed). On Linux (and some other
        systems), closing the file descriptor in another thread has
        no effect on <code class="function">select</code>(). In
        summary, any application that relies on a particular
        behavior in this scenario must be considered buggy.</p>
      </div>

      <div class="refsect2">
        <a id="select-2_sect9" name="select-2_sect9" shape="rect"> </a>

        <h3>C library/kernel ABI differences</h3>

        <p>The <code class="function">pselect</code>() interface
        described in this page is implemented by glibc. The
        underlying Linux system call is named <code class="function">pselect6</code>(). This system call has somewhat
        different behavior from the glibc wrapper function.</p>

        <p>The Linux <code class="function">pselect6</code>()
        system call modifies its <em class="parameter"><code>timeout</code></em> argument. However,
        the glibc wrapper function hides this behavior by using a
        local variable for the timeout argument that is passed to
        the system call. Thus, the glibc <code class="function">pselect</code>() function does not modify its
        <em class="parameter"><code>timeout</code></em> argument;
        this is the behavior required by POSIX.1-2001.</p>

        <p>The final argument of the <code class="function">pselect6</code>() system call is not a
        <span class="emphasis"><em>sigset_t *</em></span> pointer,
        but is instead a structure of the form:</p>

        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>

                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>

                    <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1">{</td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">const sigset_t</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                    *</td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ss</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Pointer to signal set */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ss_len</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Size (in bytes) of object pointed<br />

                        to by 'ss' */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>

        <p>This allows the system call to obtain both a pointer to
        the signal set and its size, while allowing for the fact
        that most architectures support a maximum of 6 arguments to
        a system call.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="select-2_sect10" name="select-2_sect10" shape="rect"> </a>

      <h2>BUGS</h2>

      <p>Glibc 2.0 provided a version of <code class="function">pselect</code>() that did not take a <em class="parameter"><code>sigmask</code></em> argument.</p>

      <p>Starting with version 2.1, glibc provided an emulation of
      <code class="function">pselect</code>() that was implemented
      using <a class="link" href="../htmlman2/sigprocmask.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sigprocmask</span>(2)</span></a> and
      <code class="function">select</code>(). This implementation
      remained vulnerable to the very race condition that
      <code class="function">pselect</code>() was designed to
      prevent. Modern versions of glibc use the (race-free)
      <code class="function">pselect</code>() system call on
      kernels where it is provided.</p>

      <p>On systems that lack <code class="function">pselect</code>(), reliable (and more portable)
      signal trapping can be achieved using the self-pipe trick. In
      this technique, a signal handler writes a byte to a pipe
      whose other end is monitored by <code class="function">select</code>() in the main program. (To avoid
      possibly blocking when writing to a pipe that may be full or
      reading from a pipe that may be empty, nonblocking I/O is
      used when reading from and writing to the pipe.)</p>

      <p>Under Linux, <code class="function">select</code>() may
      report a socket file descriptor as "ready for reading", while
      nevertheless a subsequent read blocks. This could for example
      happen when data has arrived but upon examination has wrong
      checksum and is discarded. There may be other circumstances
      in which a file descriptor is spuriously reported as ready.
      Thus it may be safer to use <code class="constant">O_NONBLOCK</code> on sockets that should not
      block.</p>

      <p>On Linux, <code class="function">select</code>() also
      modifies <em class="parameter"><code>timeout</code></em> if
      the call is interrupted by a signal handler (i.e., the
      <span class="errorname">EINTR</span> error return). This is
      not permitted by POSIX.1-2001. The Linux <code class="function">pselect</code>() system call has the same
      behavior, but the glibc wrapper hides this behavior by
      internally copying the <em class="parameter"><code>timeout</code></em> to a local variable and
      passing that variable to the system call.</p>
    </div>

    <div class="refsect1">
      <a id="select-2_sect11" name="select-2_sect11" shape="rect"> </a>

      <h2>EXAMPLE</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;

int
main(void)
{
    fd_set rfds;
    struct timeval tv;
    int retval;

    /* Watch stdin (fd 0) to see when it has input. */
    FD_ZERO(&amp;rfds);
    FD_SET(0, &amp;rfds);

    /* Wait up to five seconds. */
    tv.tv_sec = 5;
    tv.tv_usec = 0;

    retval = select(1, &amp;rfds, NULL, NULL, &amp;tv);
    /* Don't rely on the value of tv now! */

    if (retval == −1)
        perror("select()");
    else if (retval)
        printf("Data is available now.\n");
        /* FD_ISSET(0, &amp;rfds) will be true. */
    else
        printf("No data within five seconds.\n");

    exit(EXIT_SUCCESS);
}
</pre>
      </div>
    </div>

    <div class="refsect1">
      <a id="select-2_sect12" name="select-2_sect12" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>, <a class="link" href="../htmlman2/connect.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a>, <a class="link" href="../htmlman2/poll.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">poll</span>(2)</span></a>, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a>, <a class="link" href="../htmlman2/recv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recv</span>(2)</span></a>, <a class="link" href="../htmlman2/restart_syscall.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">restart_syscall</span>(2)</span></a>,
      <a class="link" href="../htmlman2/send.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">send</span>(2)</span></a>, <a class="link" href="../htmlman2/sigprocmask.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sigprocmask</span>(2)</span></a>, <a class="link" href="../htmlman2/write.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">write</span>(2)</span></a>, <a class="link" href="../htmlman7/epoll.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">epoll</span>(7)</span></a>, <a class="link" href="../htmlman7/time.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">time</span>(7)</span></a></p>

      <p>For a tutorial with discussion and examples, see <a class="link" href="../htmlman2/select_tut.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">select_tut</span>(2)</span></a>.</p>
    </div>

    <div class="colophon">
      <a id="select-2_sect13" name="select-2_sect13" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    This manpage is copyright (C) 1992 Drew Eckhardt,<br />

                                  copyright (C) 1995 Michael Shields.<br />

                  <br />
                  %%%LICENSE_START(VERBATIM)<br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  %%%LICENSE_END<br />
                  <br />
                  Modified 1993-07-24 by Rik Faith &lt;faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu&gt;<br />

                  Modified 1995-05-18 by Jim Van Zandt &lt;jrv<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>vanzandt.mv.com&gt;<br />

                  Sun Feb 11 14:07:00 MET 1996  Martin Schulze  &lt;joey<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>linux.de&gt;<br />

                  * layout slightly modified<br />
                  <br />
                  Modified Mon Oct 21 23:05:29 EDT 1996 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified Thu Feb 24 01:41:09 CET 2000 by aeb<br />

                  Modified Thu Feb  9 22:32:09 CET 2001 by bert hubert &lt;ahu<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>ds9a.nl&gt;, aeb<br />

                  Modified Mon Nov 11 14:35:00 PST 2002 by Ben Woodard &lt;ben<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>zork.net&gt;<br />

                  2005-03-11, mtk, modified pselect() text (it is now a system<br />

                      call in 2.6.16.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
