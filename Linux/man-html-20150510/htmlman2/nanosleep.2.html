<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>nanosleep(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="nanosleep(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="nanosleep.2" name="nanosleep.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>nanosleep — high-resolution sleep</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;time.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>nanosleep</strong>(</code></td>

            <td rowspan="1" colspan="1">const struct timespec *<var class="pdparam">req</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct timespec *<var class="pdparam">rem</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">nanosleep</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 199309L</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect1" name="nanosleep-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p><code class="function">nanosleep</code>() suspends the
      execution of the calling thread until either at least the
      time specified in *<em class="parameter"><code>req</code></em> has elapsed, or the
      delivery of a signal that triggers the invocation of a
      handler in the calling thread or that terminates the
      process.</p>

      <p>If the call is interrupted by a signal handler,
      <code class="function">nanosleep</code>() returns −1,
      sets <code class="varname">errno</code> to <span class="errorname">EINTR</span>, and writes the remaining time into
      the structure pointed to by <em class="parameter"><code>rem</code></em> unless <em class="parameter"><code>rem</code></em> is NULL. The value of
      *<em class="parameter"><code>rem</code></em> can then be used
      to call <code class="function">nanosleep</code>() again and
      complete the specified pause (but see NOTES).</p>

      <p>The structure <span class="structname">timespec</span> is
      used to specify intervals of time with nanosecond precision.
      It is defined as follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">timespec</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">time_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_sec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* seconds */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_nsec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* nanoseconds */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>The value of the nanoseconds field must be in the range 0
      to 999999999.</p>

      <p>Compared to <a class="link" href="../htmlman3/sleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sleep</span>(3)</span></a> and <a class="link" href="../htmlman3/usleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">usleep</span>(3)</span></a>, <code class="function">nanosleep</code>() has the following advantages:
      it provides a higher resolution for specifying the sleep
      interval; POSIX.1 explicitly specifies that it does not
      interact with signals; and it makes the task of resuming a
      sleep that has been interrupted by a signal handler
      easier.</p>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect2" name="nanosleep-2_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On successfully sleeping for the requested interval,
      <code class="function">nanosleep</code>() returns 0. If the
      call is interrupted by a signal handler or encounters an
      error, then it returns −1, with <code class="varname">errno</code> set to indicate the error.</p>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect3" name="nanosleep-2_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>

          <dd>
            <p>Problem with copying information from user
            space.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINTR</span></span></dt>

          <dd>
            <p>The pause has been interrupted by a signal that was
            delivered to the thread. The remaining sleep time has
            been written into *<em class="parameter"><code>rem</code></em> so that the thread
            can easily call <code class="function">nanosleep</code>() again and continue with
            the pause.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>The value in the <em class="parameter"><code>tv_nsec</code></em> field was not in
            the range 0 to 999999999 or <em class="parameter"><code>tv_sec</code></em> was negative.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect4" name="nanosleep-2_sect4" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>POSIX.1-2001.</p>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect5" name="nanosleep-2_sect5" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>If the interval specified in <em class="parameter"><code>req</code></em> is not an exact multiple of
      the granularity underlying clock (see <a class="link" href="../htmlman7/time.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">time</span>(7)</span></a>), then the interval
      will be rounded up to the next multiple. Furthermore, after
      the sleep completes, there may still be a delay before the
      CPU becomes free to once again execute the calling
      thread.</p>

      <p>The fact that <code class="function">nanosleep</code>()
      sleeps for a relative interval can be problematic if the call
      is repeatedly restarted after being interrupted by signals,
      since the time between the interruptions and restarts of the
      call will lead to drift in the time when the sleep finally
      completes. This problem can be avoided by using <a class="link" href="../htmlman2/clock_nanosleep.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_nanosleep</span>(2)</span></a> with an
      absolute time value.</p>

      <p>POSIX.1 specifies that <code class="function">nanosleep</code>() should measure time against the
      <code class="constant">CLOCK_REALTIME</code> clock. However,
      Linux measures the time using the <code class="constant">CLOCK_MONOTONIC</code> clock. This probably does
      not matter, since the POSIX.1 specification for <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_settime</span>(2)</span></a> says that
      discontinuous changes in <code class="constant">CLOCK_REALTIME</code> should not affect
      <code class="function">nanosleep</code>():</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <p>Setting the value of the <code class="constant">CLOCK_REALTIME</code> clock via <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_settime</span>(2)</span></a> shall
          have no effect on threads that are blocked waiting for a
          relative time service based upon this clock, including
          the <code class="function">nanosleep</code>() function;
          ... Consequently, these time services shall expire when
          the requested relative interval elapses, independently of
          the new or old value of the clock.</p>
        </blockquote>
      </div>

      <div class="refsect2">
        <a id="nanosleep-2_sect6" name="nanosleep-2_sect6" shape="rect"> </a>

        <h3>Old behavior</h3>

        <p>In order to support applications requiring much more
        precise pauses (e.g., in order to control some
        time-critical hardware), <code class="function">nanosleep</code>() would handle pauses of up to
        2 ms by busy waiting with microsecond precision when called
        from a thread scheduled under a real-time policy like
        <code class="constant">SCHED_FIFO</code> or <code class="constant">SCHED_RR</code>. This special extension was
        removed in kernel 2.5.39, hence is still present in current
        2.4 kernels, but not in 2.6 kernels.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect7" name="nanosleep-2_sect7" shape="rect"> </a>

      <h2>BUGS</h2>

      <p>In Linux 2.4, if <code class="function">nanosleep</code>()
      is stopped by a signal (e.g., <code class="constant">SIGTSTP</code>), then the call fails with the
      error <span class="errorname">EINTR</span> after the thread
      is resumed by a <code class="constant">SIGCONT</code> signal.
      If the system call is subsequently restarted, then the time
      that the thread spent in the stopped state is <em class="replaceable"><code>not</code></em> counted against the sleep
      interval.</p>
    </div>

    <div class="refsect1">
      <a id="nanosleep-2_sect8" name="nanosleep-2_sect8" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/clock_nanosleep.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_nanosleep</span>(2)</span></a>,
      <a class="link" href="../htmlman2/restart_syscall.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">restart_syscall</span>(2)</span></a>,
      <a class="link" href="../htmlman2/sched_setscheduler.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sched_setscheduler</span>(2)</span></a>,
      <a class="link" href="../htmlman2/timer_create.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">timer_create</span>(2)</span></a>, <a class="link" href="../htmlman3/sleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sleep</span>(3)</span></a>, <a class="link" href="../htmlman3/usleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">usleep</span>(3)</span></a>, <a class="link" href="../htmlman7/time.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">time</span>(7)</span></a></p>
    </div>

    <div class="colophon">
      <a id="nanosleep-2_sect9" name="nanosleep-2_sect9" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.72 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (C) Markus Kuhn, 1996<br />

                  and Copyright (C) Linux Foundation, 2008, written by Michael Kerrisk<br />

                      &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  <br />
                  %%%LICENSE_START(GPLv2+_DOC_FULL)<br />
                  This is free documentation; you can redistribute it and/or<br />

                  modify it under the terms of the GNU General Public License as<br />

                  published by the Free Software Foundation; either version 2 of<br />

                  the License, or (at your option) any later version.<br />

                  <br />
                  The GNU General Public License's references to "object code"<br />

                  and "executables" are to be interpreted as the output of any<br />

                  document formatting or typesetting system, including<br />

                  intermediate and printed output.<br />

                  <br />
                  This manual is distributed in the hope that it will be useful,<br />

                  but WITHOUT ANY WARRANTY; without even the implied warranty of<br />

                  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br />

                  GNU General Public License for more details.<br />

                  <br />
                  You should have received a copy of the GNU General Public<br />

                  License along with this manual; if not, see<br />

                  &lt;<a class="literalurl" href="http://www.gnu.org/licenses/" target="_top" shape="rect">http://www.gnu.org/licenses/</a>&gt;.<br />

                  %%%LICENSE_END<br />
                  <br />
                  1996-04-10  Markus Kuhn &lt;mskuhn<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cip.informatik.uni-erlangen.de&gt;<br />

                              First version written<br />

                  Modified, 2004-10-24, aeb<br />
                  2008-06-24, mtk<br />
                      Minor rewrites of some parts.<br />

                      NOTES: describe case where clock_nanosleep() can be preferable.<br />

                      NOTES: describe CLOCK_REALTIME versus CLOCK_NANOSLEEP<br />

                      Replace crufty discussion of HZ with a pointer to time(7).<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
