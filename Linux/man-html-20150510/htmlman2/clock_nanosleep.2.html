<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>clock_nanosleep(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="clock_nanosleep(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="clock-nanosleep.2" name="clock-nanosleep.2" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>clock_nanosleep — high-resolution sleep with
      specifiable clock</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;time.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>clock_nanosleep</strong>(</code></td>

            <td rowspan="1" colspan="1">clockid_t <var class="pdparam">clock_id</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">flags</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">const struct timespec *<var class="pdparam">request</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">struct timespec *<var class="pdparam">remain</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>

                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>

                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">clock_nanosleep</code>():</td>
                    </tr>

                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_XOPEN_SOURCE</code>
                      &gt;= 600 || <code class="constant">_POSIX_C_SOURCE</code> &gt;=
                      200112L</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>

            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>

          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <p>Link with <code class="option">−lrt</code>
              (only for glibc versions before 2.17).</p>
            </td>
          </tr>
        </table>
      </div>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect1" name="clock-nanosleep-2_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>Like <a class="link" href="../htmlman2/nanosleep.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">nanosleep</span>(2)</span></a>, <code class="function">clock_nanosleep</code>() allows the calling thread
      to sleep for an interval specified with nanosecond precision.
      It differs in allowing the caller to select the clock against
      which the sleep interval is to be measured, and in allowing
      the sleep interval to be specified as either an absolute or a
      relative value.</p>

      <p>The time values passed to and returned by this call are
      specified using <span class="structname">timespec</span>
      structures, defined as follows:</p>

      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>

              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>

                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">timespec</span> {</td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">time_t</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_sec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* seconds */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>

                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">long</span></td>

                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>

                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>tv_nsec</code></em>;</td>

                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* nanoseconds [0 .. 999999999] */
                    </div>
                  </td>
                </tr>

                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>

      <p>The <em class="parameter"><code>clock_id</code></em>
      argument specifies the clock against which the sleep interval
      is to be measured. This argument can have one of the
      following values:</p>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">CLOCK_REALTIME</code></span></dt>

          <dd>
            <p>A settable system-wide real-time clock.</p>
          </dd>

          <dt><span class="term"><code class="constant">CLOCK_MONOTONIC</code></span></dt>

          <dd>
            <p>A nonsettable, monotonically increasing clock that
            measures time since some unspecified point in the past
            that does not change after system startup.</p>
          </dd>

          <dt><span class="term"><code class="constant">CLOCK_PROCESS_CPUTIME_ID</code></span></dt>

          <dd>
            <p>A settable per-process clock that measures CPU time
            consumed by all threads in the process.</p>
          </dd>
        </dl>
      </div>

      <p>See <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_getres</span>(2)</span></a> for further
      details on these clocks. In addition, the CPU clock IDs
      returned by <a class="link" href="../htmlman3/clock_getcpuclockid.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_getcpuclockid</span>(3)</span></a> and
      <a class="link" href="../htmlman3/pthread_getcpuclockid.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">pthread_getcpuclockid</span>(3)</span></a>
      can also be passed in <em class="parameter"><code>clock_id</code></em>.</p>

      <p>If <em class="parameter"><code>flags</code></em> is 0,
      then the value specified in <em class="parameter"><code>request</code></em> is interpreted as an
      interval relative to the current value of the clock specified
      by <em class="parameter"><code>clock_id</code></em>.</p>

      <p>If <em class="parameter"><code>flags</code></em> is
      <code class="constant">TIMER_ABSTIME</code>, then <em class="parameter"><code>request</code></em> is interpreted as an
      absolute time as measured by the clock, <em class="parameter"><code>clock_id</code></em>. If <em class="parameter"><code>request</code></em> is less than or equal
      to the current value of the clock, then <code class="function">clock_nanosleep</code>() returns immediately
      without suspending the calling thread.</p>

      <p><code class="function">clock_nanosleep</code>() suspends
      the execution of the calling thread until either at least the
      time specified by <em class="parameter"><code>request</code></em> has elapsed, or a
      signal is delivered that causes a signal handler to be called
      or that terminates the process.</p>

      <p>If the call is interrupted by a signal handler,
      <code class="function">clock_nanosleep</code>() fails with
      the error <span class="errorname">EINTR</span>. In addition,
      if <em class="parameter"><code>remain</code></em> is not
      NULL, and <em class="parameter"><code>flags</code></em> was
      not <code class="constant">TIMER_ABSTIME</code>, it returns
      the remaining unslept time in <em class="parameter"><code>remain</code></em>. This value can then be
      used to call <code class="function">clock_nanosleep</code>()
      again and complete a (relative) sleep.</p>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect2" name="clock-nanosleep-2_sect2" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>On successfully sleeping for the requested interval,
      <code class="function">clock_nanosleep</code>() returns 0. If
      the call is interrupted by a signal handler or encounters an
      error, then it returns one of the positive error number
      listed in ERRORS.</p>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect3" name="clock-nanosleep-2_sect3" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>

          <dd>
            <p><em class="parameter"><code>request</code></em> or
            <em class="parameter"><code>remain</code></em>
            specified an invalid address.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINTR</span></span></dt>

          <dd>
            <p>The sleep was interrupted by a signal handler.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>The value in the <em class="parameter"><code>tv_nsec</code></em> field was not in
            the range 0 to 999999999 or <em class="parameter"><code>tv_sec</code></em> was negative.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p><em class="parameter"><code>clock_id</code></em> was
            invalid. (<code class="constant">CLOCK_THREAD_CPUTIME_ID</code> is not a
            permitted value for <em class="parameter"><code>clock_id</code></em>.)</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect4" name="clock-nanosleep-2_sect4" shape="rect"> </a>

      <h2>VERSIONS</h2>

      <p>The <code class="function">clock_nanosleep</code>() system
      call first appeared in Linux 2.6. Support is available in
      glibc since version 2.1.</p>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect5" name="clock-nanosleep-2_sect5" shape="rect"> </a>

      <h2>CONFORMING TO</h2>

      <p>POSIX.1-2001.</p>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect6" name="clock-nanosleep-2_sect6" shape="rect"> </a>

      <h2>NOTES</h2>

      <p>If the interval specified in <em class="parameter"><code>request</code></em> is not an exact
      multiple of the granularity underlying clock (see <a class="link" href="../htmlman7/time.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">time</span>(7)</span></a>), then the interval
      will be rounded up to the next multiple. Furthermore, after
      the sleep completes, there may still be a delay before the
      CPU becomes free to once again execute the calling
      thread.</p>

      <p>Using an absolute timer is useful for preventing timer
      drift problems of the type described in <a class="link" href="../htmlman2/nanosleep.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">nanosleep</span>(2)</span></a>. (Such
      problems are exacerbated in programs that try to restart a
      relative sleep that is repeatedly interrupted by signals.) To
      perform a relative sleep that avoids these problems, call
      <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_gettime</span>(2)</span></a> for the
      desired clock, add the desired interval to the returned time
      value, and then call <code class="function">clock_nanosleep</code>() with the <code class="constant">TIMER_ABSTIME</code> flag.</p>

      <p><code class="function">clock_nanosleep</code>() is never
      restarted after being interrupted by a signal handler,
      regardless of the use of the <a class="link" href="../htmlman2/sigaction.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sigaction</span>(2)</span></a> <code class="constant">SA_RESTART</code> flag.</p>

      <p>The <em class="parameter"><code>remain</code></em>
      argument is unused, and unnecessary, when <em class="parameter"><code>flags</code></em> is <code class="constant">TIMER_ABSTIME</code>. (An absolute sleep can be
      restarted using the same <em class="parameter"><code>request</code></em> argument.)</p>

      <p>POSIX.1 specifies that <code class="function">clock_nanosleep</code>() has no effect on signals
      dispositions or the signal mask.</p>

      <p>POSIX.1 specifies that after changing the value of the
      <code class="constant">CLOCK_REALTIME</code> clock via
      <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_settime</span>(2)</span></a>, the new
      clock value shall be used to determine the time at which a
      thread blocked on an absolute <code class="function">clock_nanosleep</code>() will wake up; if the new
      clock value falls past the end of the sleep interval, then
      the <code class="function">clock_nanosleep</code>() call will
      return immediately.</p>

      <p>POSIX.1 specifies that changing the value of the
      <code class="constant">CLOCK_REALTIME</code> clock via
      <a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_settime</span>(2)</span></a> shall have
      no effect on a thread that is blocked on a relative
      <code class="function">clock_nanosleep</code>().</p>
    </div>

    <div class="refsect1">
      <a id="clock-nanosleep-2_sect7" name="clock-nanosleep-2_sect7" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/clock_getres.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">clock_getres</span>(2)</span></a>, <a class="link" href="../htmlman2/nanosleep.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">nanosleep</span>(2)</span></a>, <a class="link" href="../htmlman2/restart_syscall.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">restart_syscall</span>(2)</span></a>,
      <a class="link" href="../htmlman2/timer_create.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">timer_create</span>(2)</span></a>, <a class="link" href="../htmlman3/sleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sleep</span>(3)</span></a>, <a class="link" href="../htmlman3/usleep.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">usleep</span>(3)</span></a>, <a class="link" href="../htmlman7/time.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">time</span>(7)</span></a></p>
    </div>

    <div class="colophon">
      <a id="clock-nanosleep-2_sect8" name="clock-nanosleep-2_sect8" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 2008, Linux Foundation, written by Michael Kerrisk<br />

                  &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />
                  <br />
                  %%%LICENSE_START(VERBATIM)<br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  %%%LICENSE_END<br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
