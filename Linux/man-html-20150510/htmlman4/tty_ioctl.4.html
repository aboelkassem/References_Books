<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>tty_ioctl(4) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="tty_ioctl(4) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index4.html" shape="rect">Section 4</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="tty-ioctl.4" name="tty-ioctl.4" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>tty_ioctl — ioctls for terminals and serial
      lines</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;termios.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>ioctl</strong>(</code></td>

            <td rowspan="1" colspan="1">int <var class="pdparam">fd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">cmd</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1"><var class="pdparam">...</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="tty-ioctl-4_sect1" name="tty-ioctl-4_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>The <a class="link" href="../htmlman2/ioctl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> call for terminals
      and serial ports accepts many possible command arguments.
      Most require a third argument, of varying type, here called
      <code class="function">argp</code> or <code class="function">arg</code>.</p>

      <p>Use of <code class="function">ioctl</code> makes for
      nonportable programs. Use the POSIX interface described in
      <a class="link" href="../htmlman3/termios.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">termios</span>(3)</span></a> whenever
      possible.</p>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect2" name="tty-ioctl-4_sect2" shape="rect"> </a>

        <h3>Get and set terminal attributes</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCGETS struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcgetattr(fd, argp)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Get the current serial port settings.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCSETS const struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcsetattr(fd, TCSANOW,
              argp)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Set the current serial port settings.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCSETSW const struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcsetattr(fd, TCSADRAIN,
              argp)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Allow the output buffer to drain, and set the current
        serial port settings.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCSETSF const struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcsetattr(fd, TCSAFLUSH,
              argp)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Allow the output buffer to drain, discard pending input,
        and set the current serial port settings.</p>

        <p>The following four ioctls are just like <code class="constant">TCGETS</code>, <code class="constant">TCSETS</code>, <code class="constant">TCSETSW</code>, <code class="constant">TCSETSF</code>, except that they take a
        <span class="emphasis"><em>struct termio *</em></span>
        instead of a <span class="emphasis"><em>struct termios
        *</em></span>.</p>

        <div class="itemizedlist">
          <ul class="itemizedlist" style="list-style-type: disc;">
            <li class="listitem">
              <p><span class="emphasis"><em>TCGETA struct termio
              *</em></span><code class="function">argp</code></p>
            </li>

            <li class="listitem">
              <p><span class="emphasis"><em>TCSETA const struct
              termio *</em></span><code class="function">argp</code></p>
            </li>

            <li class="listitem">
              <p><span class="emphasis"><em>TCSETAW const struct
              termio *</em></span><code class="function">argp</code></p>
            </li>

            <li class="listitem">
              <p><span class="emphasis"><em>TCSETAF const struct
              termio *</em></span><code class="function">argp</code></p>
            </li>
          </ul>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect3" name="tty-ioctl-4_sect3" shape="rect"> </a>

        <h3>Locking the termios structure</h3>

        <p>The <code class="function">termios</code> structure of a
        terminal can be locked. The lock is itself a <code class="function">termios</code> structure, with nonzero bits or
        fields indicating a locked value.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGLCKTRMIOS struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Gets the locking status of the <code class="function">termios</code> structure of the
              terminal.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCSLCKTRMIOS const struct termios
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Sets the locking status of the <code class="function">termios</code> structure of the terminal.
              Only a process with the <code class="constant">CAP_SYS_ADMIN</code> capability can do
              this.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect4" name="tty-ioctl-4_sect4" shape="rect"> </a>

        <h3>Get and set window size</h3>

        <p>Window sizes are kept in the kernel, but not used by the
        kernel (except in the case of virtual consoles, where the
        kernel will update the window size when the size of the
        virtual console changes, for example, by loading a new
        font).</p>

        <p>The following constants and structure are defined in
        <code class="literal">&lt;</code><code class="filename">sys/ioctl.h</code><code class="literal">&gt;</code></p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGWINSZ struct winsize
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get window size.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCSWINSZ const struct winsize
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Set window size.</p>
            </dd>
          </dl>
        </div>

        <p>The struct used by these ioctls is defined as</p>

        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>

                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>

                    <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">winsize</span> {</td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ws_row</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1"> </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ws_col</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1"> </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ws_xpixel</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* unused */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>

                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>

                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>

                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>ws_ypixel</code></em>;</td>

                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        /* unused */
                      </div>
                    </td>
                  </tr>

                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>

        <p>When the window size changes, a <code class="constant">SIGWINCH</code> signal is sent to the foreground
        process group.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect5" name="tty-ioctl-4_sect5" shape="rect"> </a>

        <h3>Sending a break</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCSBRK int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcsendbreak(fd, arg)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>If the terminal is using asynchronous serial data
        transmission, and <code class="function">arg</code> is
        zero, then send a break (a stream of zero bits) for between
        0.25 and 0.5 seconds. If the terminal is not using
        asynchronous serial data transmission, then either a break
        is sent, or the function returns without doing anything.
        When <code class="function">arg</code> is nonzero, nobody
        knows what will happen.</p>

        <p>(SVr4, UnixWare, Solaris, Linux treat <em class="replaceable"><code>tcsendbreak(fd,arg)</code></em> with
        nonzero <code class="function">arg</code> like <em class="replaceable"><code>tcdrain(fd)</code></em>. SunOS treats
        <code class="function">arg</code> as a multiplier, and
        sends a stream of bits <code class="function">arg</code>
        times as long as done for zero <code class="function">arg</code>. DG/UX and AIX treat <code class="function">arg</code> (when nonzero) as a time interval
        measured in milliseconds. HP-UX ignores <code class="function">arg</code>.)</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCSBRKP int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>So-called "POSIX version" of <code class="constant">TCSBRK</code>. It treats nonzero
              <code class="function">arg</code> as a timeinterval
              measured in deciseconds, and does nothing when the
              driver does not support breaks.</p>
            </dd>

            <dt><span class="term">TIOCSBRK void</span></dt>

            <dd>
              <p>Turn break on, that is, start sending zero
              bits.</p>
            </dd>

            <dt><span class="term">TIOCCBRK void</span></dt>

            <dd>
              <p>Turn break off, that is, stop sending zero
              bits.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect6" name="tty-ioctl-4_sect6" shape="rect"> </a>

        <h3>Software flow control</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TCXONC int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcflow(fd, arg)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>See <a class="link" href="../htmlman3/termios.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">tcflow</span>(3)</span></a> for the
        argument values <code class="constant">TCOOFF</code>,
        <code class="constant">TCOON</code>, <code class="constant">TCIOFF</code>, <code class="constant">TCION</code>.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect7" name="tty-ioctl-4_sect7" shape="rect"> </a>

        <h3>Buffer count and flushing</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>FIONREAD int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the number of bytes in the input buffer.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCINQ int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Same as <code class="constant">FIONREAD</code>.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCOUTQ int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the number of bytes in the output buffer.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TCFLSH int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcflush(fd, arg)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>See <a class="link" href="../htmlman3/termios.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">tcflush</span>(3)</span></a> for the
        argument values <code class="constant">TCIFLUSH</code>,
        <code class="constant">TCOFLUSH</code>, <code class="constant">TCIOFLUSH</code>.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect8" name="tty-ioctl-4_sect8" shape="rect"> </a>

        <h3>Faking input</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCSTI const char
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Insert the given byte in the input queue.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect9" name="tty-ioctl-4_sect9" shape="rect"> </a>

        <h3>Redirecting console output</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term">TIOCCONS void</span></dt>

            <dd>
              <p>Redirect output that would have gone to
              <code class="filename">/dev/console</code> or
              <code class="filename">/dev/tty0</code> to the given
              terminal. If that was a pseudoterminal master, send
              it to the slave. In Linux before version 2.6.10,
              anybody can do this as long as the output was not
              redirected yet; since version 2.6.10, only a process
              with the <code class="constant">CAP_SYS_ADMIN</code>
              capability may do this. If output was redirected
              already <span class="errorname">EBUSY</span> is
              returned, but redirection can be stopped by using
              this ioctl with <em class="parameter"><code>fd</code></em> pointing at
              <code class="filename">/dev/console</code> or
              <code class="filename">/dev/tty0</code>.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect10" name="tty-ioctl-4_sect10" shape="rect"> </a>

        <h3>Controlling terminal</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCSCTTY int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>Make the given terminal the controlling terminal
              of the calling process. The calling process must be a
              session leader and not have a controlling terminal
              already. For this case, <code class="function">arg</code> should be specified as
              zero.</p>

              <p>If this terminal is already the controlling
              terminal of a different session group, then the ioctl
              fails with <span class="errorname">EPERM</span>,
              unless the caller has the <code class="constant">CAP_SYS_ADMIN</code> capability and
              <code class="function">arg</code> equals 1, in which
              case the terminal is stolen, and all processes that
              had it as controlling terminal lose it.</p>
            </dd>

            <dt><span class="term">TIOCNOTTY void</span></dt>

            <dd>
              <p>If the given terminal was the controlling terminal
              of the calling process, give up this controlling
              terminal. If the process was session leader, then
              send <code class="constant">SIGHUP</code> and
              <code class="constant">SIGCONT</code> to the
              foreground process group and all processes in the
              current session lose their controlling terminal.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect11" name="tty-ioctl-4_sect11" shape="rect"> </a>

        <h3>Process group and session ID</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGPGRP pid_t
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>When successful, equivalent to <span class="emphasis"><em>*argp = tcgetpgrp(fd)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Get the process group ID of the foreground process group
        on this terminal.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCSPGRP const pid_t
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Equivalent to <span class="emphasis"><em>tcsetpgrp(fd, *argp)</em></span>.</p>
            </dd>
          </dl>
        </div>

        <p>Set the foreground process group ID of this
        terminal.</p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGSID pid_t *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the session ID of the given terminal. This
              will fail with <span class="errorname">ENOTTY</span>
              in case the terminal is not a master pseudoterminal
              and not our controlling terminal. Strange.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect12" name="tty-ioctl-4_sect12" shape="rect"> </a>

        <h3>Exclusive mode</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term">TIOCEXCL void</span></dt>

            <dd>
              <p>Put the terminal into exclusive mode. No further
              <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> operations
              on the terminal are permitted. (They will fail with
              <span class="errorname">EBUSY</span>, except for a
              process with the <code class="constant">CAP_SYS_ADMIN</code> capability.)</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCGEXCL int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>If the terminal is currently in exclusive mode,
              place a nonzero value in the location pointed to by
              <code class="function">argp</code>; otherwise, place
              zero in <code class="function">*argp</code> (since
              Linux 3.8).</p>
            </dd>

            <dt><span class="term">TIOCNXCL void</span></dt>

            <dd>
              <p>Disable exclusive mode.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect13" name="tty-ioctl-4_sect13" shape="rect"> </a>

        <h3>Line discipline</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGETD int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the line discipline of the terminal.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCSETD const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Set the line discipline of the terminal.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect14" name="tty-ioctl-4_sect14" shape="rect"> </a>

        <h3>Pseudoterminal ioctls</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCPKT const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Enable (when *<code class="function">argp</code>
              is nonzero) or disable packet mode. Can be applied to
              the master side of a pseudoterminal only (and will
              return <span class="errorname">ENOTTY</span>
              otherwise). In packet mode, each subsequent <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> will return
              a packet that either contains a single nonzero
              control byte, or has a single byte containing zero
              (' ') followed by data written on the slave side
              of the pseudoterminal. If the first byte is not
              <code class="constant">TIOCPKT_DATA</code> (0), it is
              an OR of one or more of the following bits:</p>

              <div class="informalexample">
                <pre class="programlisting" xml:space="preserve">
TIOCPKT_FLUSHREAD   The read queue for the terminal is flushed.
TIOCPKT_FLUSHWRITE  The write queue for the terminal is flushed.
TIOCPKT_STOP        Output to the terminal is stopped.
TIOCPKT_START       Output to the terminal is restarted.
TIOCPKT_DOSTOP      The start and stop characters are <code class="literal">^S</code>/<code class="literal">^Q</code>.
TIOCPKT_NOSTOP      The start and stop characters are not <code class="literal">^S</code>/<code class="literal">^Q</code>.
</pre>
              </div>

              <p>While this mode is in use, the presence of control
              status information to be read from the master side
              may be detected by a <a class="link" href="../htmlman2/select.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">select</span>(2)</span></a> for
              exceptional conditions.</p>

              <p>This mode is used by <span class="citerefentry"><span class="refentrytitle">rlogin</span>(1)</span> and
              <span class="citerefentry"><span class="refentrytitle">rlogind</span>(8)</span> to implement
              a remote-echoed, locally <code class="literal">^S</code>/<code class="literal">^Q</code>
              flow-controlled remote login.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOGCPKT const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Return the current packet mode setting in the
              integer pointed to by <code class="function">argp</code> (since Linux 3.8).</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCSPTLCK int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Set (if <code class="function">*argp</code> is
              nonzero) or remove (if <code class="function">*argp</code> is zero) the pseudoterminal
              slave device. (See also <a class="link" href="../htmlman3/unlockpt.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">unlockpt</span>(3)</span></a>.)</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCGPTLCK int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Place the current lock state of the pseudoterminal
              slave device in the location pointed to by
              <code class="function">argp</code> (since Linux
              3.8).</p>
            </dd>
          </dl>
        </div>

        <p>The BSD ioctls <code class="constant">TIOCSTOP</code>,
        <code class="constant">TIOCSTART</code>, <code class="constant">TIOCUCNTL</code>, <code class="constant">TIOCREMOTE</code> have not been implemented
        under Linux.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect15" name="tty-ioctl-4_sect15" shape="rect"> </a>

        <h3>Modem control</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCMGET int *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the status of modem bits.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCMSET const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Set the status of modem bits.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCMBIC const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Clear the indicated modem bits.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCMBIS const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Set the indicated modem bits.</p>
            </dd>
          </dl>
        </div>

        <p>The following bits are used by the above ioctls:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
TIOCM_LE        DSR (data set ready/line enable)
TIOCM_DTR       DTR (data terminal ready)
TIOCM_RTS       RTS (request to send)
TIOCM_ST        Secondary TXD (transmit)
TIOCM_SR        Secondary RXD (receive)
TIOCM_CTS       CTS (clear to send)
TIOCM_CAR       DCD (data carrier detect)
TIOCM_CD         see TIOCM_CAR
TIOCM_RNG       RNG (ring)
TIOCM_RI         see TIOCM_RNG
TIOCM_DSR       DSR (data set ready)
</pre>
        </div>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCMIWAIT int</em></span> <code class="function">arg</code></span></dt>

            <dd>
              <p>Wait for any of the 4 modem bits (DCD, RI, DSR,
              CTS) to change. The bits of interest are specified as
              a bit mask in <code class="function">arg</code>, by
              ORing together any of the bit values, <code class="constant">TIOCM_RNG</code>, <code class="constant">TIOCM_DSR</code>, <code class="constant">TIOCM_CD</code>, and <code class="constant">TIOCM_CTS</code>. The caller should use
              <code class="constant">TIOCGICOUNT</code> to see
              which bit has changed.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCGICOUNT struct
            serial_icounter_struct *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get counts of input serial line interrupts (DCD,
              RI, DSR, CTS). The counts are written to the
              <code class="function">serial_icounter_struct</code>
              structure pointed to by <code class="function">argp</code>.</p>

              <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                <table border="0" summary="Note">
                  <tr>
                    <td rowspan="2" align="center" valign="top" width="25" colspan="1"><img alt="[Note]" src="../stylesheet/note.png" /></td>

                    <th align="left" rowspan="1" colspan="1">Note</th>
                  </tr>

                  <tr>
                    <td align="left" valign="top" rowspan="1" colspan="1">
                      <p>Both 1-&gt;0 and 0-&gt;1 transitions are
                      counted, except for RI, where only 0-&gt;1
                      transitions are counted.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect16" name="tty-ioctl-4_sect16" shape="rect"> </a>

        <h3>Marking a line as local</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCGSOFTCAR int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>("Get software carrier flag") Get the status of
              the CLOCAL flag in the c_cflag field of the
              <code class="function">termios</code> structure.</p>
            </dd>

            <dt><span class="term"><span class="emphasis"><em>TIOCSSOFTCAR const int
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>("Set software carrier flag") Set the CLOCAL flag
              in the <code class="function">termios</code>
              structure when *<code class="function">argp</code> is
              nonzero, and clear it otherwise.</p>
            </dd>
          </dl>
        </div>

        <p>If the <code class="constant">CLOCAL</code> flag for a
        line is off, the hardware carrier detect (DCD) signal is
        significant, and an <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> of the
        corresponding terminal will block until DCD is asserted,
        unless the <code class="constant">O_NONBLOCK</code> flag is
        given. If <code class="constant">CLOCAL</code> is set, the
        line behaves as if DCD is always asserted. The software
        carrier flag is usually turned on for local devices, and is
        off for lines with modems.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect17" name="tty-ioctl-4_sect17" shape="rect"> </a>

        <h3>Linux-specific</h3>

        <p>For the <code class="constant">TIOCLINUX</code> ioctl,
        see <a class="link" href="../htmlman4/console_ioctl.4.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">console_ioctl</span>(4)</span></a>.</p>
      </div>

      <div class="refsect2">
        <a id="tty-ioctl-4_sect18" name="tty-ioctl-4_sect18" shape="rect"> </a>

        <h3>Kernel debugging</h3>

        <p><span class="emphasis"><em>#include
        &lt;linux/tty.h&gt;</em></span></p>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><span class="emphasis"><em>TIOCTTYGSTRUCT struct tty_struct
            *</em></span><code class="function">argp</code></span></dt>

            <dd>
              <p>Get the <code class="function">tty_struct</code>
              corresponding to <em class="parameter"><code>fd</code></em>.</p>
            </dd>
          </dl>
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="tty-ioctl-4_sect19" name="tty-ioctl-4_sect19" shape="rect"> </a>

      <h2>RETURN VALUE</h2>

      <p>The <a class="link" href="../htmlman2/ioctl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a> system call
      returns 0 on success. On error, it returns −1 and sets
      <code class="varname">errno</code> appropriately.</p>
    </div>

    <div class="refsect1">
      <a id="tty-ioctl-4_sect20" name="tty-ioctl-4_sect20" shape="rect"> </a>

      <h2>ERRORS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>

          <dd>
            <p>Invalid command parameter.</p>
          </dd>

          <dt><span class="term"><code class="constant">ENOIOCTLCMD</code></span></dt>

          <dd>
            <p>Unknown command.</p>
          </dd>

          <dt><span class="term"><span class="errorname">ENOTTY</span></span></dt>

          <dd>
            <p>Inappropriate <em class="parameter"><code>fd</code></em>.</p>
          </dd>

          <dt><span class="term"><span class="errorname">EPERM</span></span></dt>

          <dd>
            <p>Insufficient permission.</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="tty-ioctl-4_sect21" name="tty-ioctl-4_sect21" shape="rect"> </a>

      <h2>EXAMPLE</h2>

      <p>Check the condition of DTR on the serial port.</p>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;termios.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/ioctl.h&gt;

int
main(void)
{
    int fd, serial;

    fd = open("/dev/ttyS0", O_RDONLY);
    ioctl(fd, TIOCMGET, &amp;serial);
    if (serial &amp; TIOCM_DTR)
        puts("TIOCM_DTR is set");
    else
        puts("TIOCM_DTR is not set");
    close(fd);
}
</pre>
      </div>
    </div>

    <div class="refsect1">
      <a id="tty-ioctl-4_sect22" name="tty-ioctl-4_sect22" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><a class="link" href="../htmlman2/ioctl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ioctl</span>(2)</span></a>, <a class="link" href="../htmlman3/termios.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">termios</span>(3)</span></a>, <a class="link" href="../htmlman4/console_ioctl.4.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">console_ioctl</span>(4)</span></a>, <a class="link" href="../htmlman7/pty.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">pty</span>(7)</span></a></p>
    </div>

    <div class="colophon">
      <a id="tty-ioctl-4_sect23" name="tty-ioctl-4_sect23" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 4.00 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright 2002 Walter Harms &lt;walter.harms<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>informatik.uni-oldenburg.de&gt;<br />

                  and Andries Brouwer &lt;aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl&gt;.<br />

                  <br />
                  %%%LICENSE_START(GPL_NOVERSION_ONELINE)<br />
                  Distributed under GPL<br />
                  %%%LICENSE_END<br />
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
