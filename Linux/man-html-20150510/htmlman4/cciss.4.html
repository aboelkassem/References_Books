<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>cciss(4) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="cciss(4) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index4.html" shape="rect">Section 4</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="cciss.4" name="cciss.4" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>cciss — HP Smart Array block driver</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
modprobe cciss [ cciss_allow_hpsa=1 ]
  
</pre>
      </div>
    </div>

    <div class="refsect1">
      <a id="cciss-4_sect1" name="cciss-4_sect1" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p><code class="function">cciss</code> is a block driver for
      older HP Smart Array RAID controllers.</p>

      <div class="refsect2">
        <a id="cciss-4_sect2" name="cciss-4_sect2" shape="rect"> </a>

        <h3>Options</h3>

        <p><em class="replaceable"><code>cciss_allow_hpsa=1</code></em>: This
        option prevents the <code class="function">cciss</code>
        driver from attempting to drive any controllers that the
        <a class="link" href="../htmlman4/hpsa.4.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hpsa</span>(4)</span></a> driver is capable
        of controlling, which is to say, the <code class="function">cciss</code> driver is restricted by this option
        to the following controllers:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
    Smart Array 5300
    Smart Array 5i
    Smart Array 532
    Smart Array 5312
    Smart Array 641
    Smart Array 642
    Smart Array 6400
    Smart Array 6400 EM
    Smart Array 6i
    Smart Array P600
    Smart Array P400i
    Smart Array E200i
    Smart Array E200
    Smart Array E200i
    Smart Array E200i
    Smart Array E200i
    Smart Array E500
</pre>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect3" name="cciss-4_sect3" shape="rect"> </a>

        <h3>Supported hardware</h3>

        <p>The <code class="function">cciss</code> driver supports
        the following Smart Array boards:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
    Smart Array 5300
    Smart Array 5i
    Smart Array 532
    Smart Array 5312
    Smart Array 641
    Smart Array 642
    Smart Array 6400
    Smart Array 6400 U320 Expansion Module
    Smart Array 6i
    Smart Array P600
    Smart Array P800
    Smart Array E400
    Smart Array P400i
    Smart Array E200
    Smart Array E200i
    Smart Array E500
    Smart Array P700m
    Smart Array P212
    Smart Array P410
    Smart Array P410i
    Smart Array P411
    Smart Array P812
    Smart Array P712m
    Smart Array P711m
</pre>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect4" name="cciss-4_sect4" shape="rect"> </a>

        <h3>Configuration details</h3>

        <p>To configure HP Smart Array controllers, use the HP
        Array Configuration Utility (either <span class="citerefentry"><span class="refentrytitle">hpacuxe</span>(8)</span> or <span class="citerefentry"><span class="refentrytitle">hpacucli</span>(8)</span>) or the Offline
        ROM-based Configuration Utility (ORCA) run from the Smart
        Array's option ROM at boot time.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="cciss-4_sect5" name="cciss-4_sect5" shape="rect"> </a>

      <h2>FILES</h2>

      <div class="refsect2">
        <a id="cciss-4_sect6" name="cciss-4_sect6" shape="rect"> </a>

        <h3>Device nodes</h3>

        <p>The device naming scheme is as follows:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
Major numbers:

    104     cciss0
    105     cciss1
    106     cciss2
    105     cciss3
    108     cciss4
    109     cciss5
    110     cciss6
    111     cciss7

Minor numbers:

    b7 b6 b5 b4 b3 b2 b1 b0
    |----+----| |----+----|
         |           |
         |           +-------- Partition ID (0=wholedev, 1-15 partition)
         |
         +-------------------- Logical Volume number

The device naming scheme is:

    /dev/cciss/c0d0         Controller 0, disk 0, whole device
    /dev/cciss/c0d0p1       Controller 0, disk 0, partition 1
    /dev/cciss/c0d0p2       Controller 0, disk 0, partition 2
    /dev/cciss/c0d0p3       Controller 0, disk 0, partition 3

    /dev/cciss/c1d1         Controller 1, disk 1, whole device
    /dev/cciss/c1d1p1       Controller 1, disk 1, partition 1
    /dev/cciss/c1d1p2       Controller 1, disk 1, partition 2
    /dev/cciss/c1d1p3       Controller 1, disk 1, partition 3
</pre>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect7" name="cciss-4_sect7" shape="rect"> </a>

        <h3>Files in /proc</h3>

        <p>The files <code class="filename">/proc/driver/cciss/cciss[0-9]+</code> contain
        information about the configuration of each controller. For
        example:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
    $ <span class="emphasis"><em>cd /proc/driver/cciss</em></span>
    $ <span class="emphasis"><em>ls -l</em></span>
    total 0
    -rw-r--r-- 1 root root 0 2010-09-10 10:38 cciss0
    -rw-r--r-- 1 root root 0 2010-09-10 10:38 cciss1
    -rw-r--r-- 1 root root 0 2010-09-10 10:38 cciss2
    $ <span class="emphasis"><em>cat cciss2</em></span>
    cciss2: HP Smart Array P800 Controller
    Board ID: 0x3223103c
    Firmware Version: 7.14
    IRQ: 16
    Logical drives: 1
    Current Q depth: 0
    Current # commands on controller: 0
    Max Q depth since init: 1
    Max # commands on controller since init: 2
    Max SG entries since init: 32
    Sequential access devices: 0

    cciss/c2d0:   36.38GB       RAID 0
</pre>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect8" name="cciss-4_sect8" shape="rect"> </a>

        <h3>Files in /sys</h3>

        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/model</code></span></dt>

            <dd>
              <p>Displays the SCSI INQUIRY page 0 model for logical
              drive <code class="constant">Y</code> of controller
              <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/rev</code></span></dt>

            <dd>
              <p>Displays the SCSI INQUIRY page 0 revision for
              logical drive <code class="constant">Y</code> of
              controller <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/unique_id</code></span></dt>

            <dd>
              <p>Displays the SCSI INQUIRY page 83 serial number
              for logical drive <code class="constant">Y</code> of
              controller <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/vendor</code></span></dt>

            <dd>
              <p>Displays the SCSI INQUIRY page 0 vendor for
              logical drive <code class="constant">Y</code> of
              controller <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/block:cciss!cXdY</code></span></dt>

            <dd>
              <p>A symbolic link to <code class="filename">/sys/block/cciss!cXdY</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/rescan</code></span></dt>

            <dd>
              <p>When this file is written to, the driver rescans
              the controller to discover any new, removed, or
              modified logical drives.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/resettable</code></span></dt>

            <dd>
              <p>A value of 1 displayed in this file indicates that
              the "reset_devices=1" kernel parameter (used by
              <code class="function">kdump</code>) is honored by
              this controller. A value of 0 indicates that the
              "reset_devices=1" kernel parameter will not be
              honored. Some models of Smart Array are not able to
              honor this parameter.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/lunid</code></span></dt>

            <dd>
              <p>Displays the 8-byte LUN ID used to address logical
              drive <code class="constant">Y</code> of controller
              <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/raid_level</code></span></dt>

            <dd>
              <p>Displays the RAID level of logical drive
              <code class="constant">Y</code> of controller
              <code class="constant">X</code>.</p>
            </dd>

            <dt><span class="term"><code class="filename">/sys/bus/pci/devices/&lt;dev&gt;/ccissX/cXdY/usage_count</code></span></dt>

            <dd>
              <p>Displays the usage count (number of opens) of
              logical drive <code class="constant">Y</code> of
              controller <code class="constant">X</code>.</p>
            </dd>
          </dl>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect9" name="cciss-4_sect9" shape="rect"> </a>

        <h3>SCSI tape drive and medium changer support</h3>

        <p>SCSI sequential access devices and medium changer
        devices are supported and appropriate device nodes are
        automatically created (e.g., <code class="filename">/dev/st0</code>, <code class="filename">/dev/st1</code>, etc.; see <a class="link" href="../htmlman4/st.4.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">st</span>(4)</span></a> for more details.)
        You must enable "SCSI tape drive support for Smart Array
        5xxx" and "SCSI support" in your kernel configuration to be
        able to use SCSI tape drives with your Smart Array 5xxx
        controller.</p>

        <p>Additionally, note that the driver will not engage the
        SCSI core at init time. The driver must be directed to
        dynamically engage the SCSI core via the <code class="filename">/proc</code> filesystem entry, which the "block"
        side of the driver creates as <code class="filename">/proc/driver/cciss/cciss*</code> at run time.
        This is because at driver init time, the SCSI core may not
        yet be initialized (because the driver is a block driver)
        and attempting to register it with the SCSI core in such a
        case would cause a hang. This is best done via an
        initialization script (typically in <code class="filename">/etc/init.d</code>, but could vary depending on
        distribution). For example:</p>

        <div class="informalexample">
          <pre class="programlisting" xml:space="preserve">
    for x in /proc/driver/cciss/cciss[0-9]*
    do
        echo "engage scsi" &gt; $x
    done
</pre>
        </div>

        <p>Once the SCSI core is engaged by the driver, it cannot
        be disengaged (except by unloading the driver, if it
        happens to be linked as a module.)</p>

        <p>Note also that if no sequential access devices or medium
        changers are detected, the SCSI core will not be engaged by
        the action of the above script.</p>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect10" name="cciss-4_sect10" shape="rect"> </a>

        <h3>Hot plug support for SCSI tape drives</h3>

        <p>Hot plugging of SCSI tape drives is supported, with some
        caveats. The <code class="function">cciss</code> driver
        must be informed that changes to the SCSI bus have been
        made. This may be done via the <code class="filename">/proc</code> filesystem. For example:</p>

        <p>echo "rescan" &gt; /proc/scsi/cciss0/1</p>

        <p>This causes the driver to:</p>

        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="orderedlist">
              <ol class="orderedlist" type="1">
                <li class="listitem">
                  <p>query the adapter about changes to the
                  physical SCSI buses and/or fibre channel
                  arbitrated loop, and</p>
                </li>

                <li class="listitem">
                  <p>make note of any new or removed sequential
                  access devices or medium changers.</p>
                </li>
              </ol>
            </div>
          </blockquote>
        </div>

        <p>The driver will output messages indicating which devices
        have been added or removed and the controller, bus, target,
        and lun used to address each device. The driver then
        notifies the SCSI midlayer of these changes.</p>

        <p>Note that the naming convention of the <code class="filename">/proc</code> filesystem entries contains a
        number in addition to the driver name (e.g., "cciss0"
        instead of just "cciss", which you might expect).</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25" colspan="1"><img alt="[Note]" src="../stylesheet/note.png" /></td>

              <th align="left" rowspan="1" colspan="1">Note</th>
            </tr>

            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p><code class="function">Only</code> sequential
                access devices and medium changers are presented as
                SCSI devices to the SCSI midlayer by the
                <code class="function">cciss</code> driver.
                Specifically, physical SCSI disk drives are
                <code class="function">not</code> presented to the
                SCSI midlayer. The only disk devices that are
                presented to the kernel are logical drives that the
                array controller constructs from regions on the
                physical drives. The logical drives are presented
                to the block layer (not to the SCSI midlayer). It
                is important for the driver to prevent the kernel
                from accessing the physical drives directly, since
                these drives are used by the array controller to
                construct the logical drives.</p>
              </td>
            </tr>
          </table>
        </div>
      </div>

      <div class="refsect2">
        <a id="cciss-4_sect11" name="cciss-4_sect11" shape="rect"> </a>

        <h3>SCSI error handling for tape drives and medium
        changers</h3>

        <p>The Linux SCSI midlayer provides an error-handling
        protocol that is initiated whenever a SCSI command fails to
        complete within a certain amount of time (which can vary
        depending on the command). The <code class="function">cciss</code> driver participates in this
        protocol to some extent. The normal protocol is a four-step
        process:</p>

        <div class="itemizedlist">
          <ul class="itemizedlist" style="list-style-type: disc;">
            <li class="listitem">
              <p>First, the device is told to abort the
              command.</p>
            </li>

            <li class="listitem">
              <p>If that doesn't work, the device is reset.</p>
            </li>

            <li class="listitem">
              <p>If that doesn't work, the SCSI bus is reset.</p>
            </li>

            <li class="listitem">
              <p>If that doesn't work, the host bus adapter is
              reset.</p>
            </li>
          </ul>
        </div>

        <p>The <code class="function">cciss</code> driver is a
        block driver as well as a SCSI driver and only the tape
        drives and medium changers are presented to the SCSI
        midlayer. Furthermore, unlike more straightforward SCSI
        drivers, disk I/O continues through the block side during
        the SCSI error-recovery process. Therefore, the
        <code class="function">cciss</code> driver implements only
        the first two of these actions, aborting the command, and
        resetting the device. Note also that most tape drives will
        not oblige in aborting commands, and sometimes it appears
        they will not even obey a reset command, though in most
        circumstances they will. If the command cannot be aborted
        and the device cannot be reset, the device will be set
        offline.</p>

        <p>In the event that the error-handling code is triggered
        and a tape drive is successfully reset or the tardy command
        is successfully aborted, the tape drive may still not allow
        I/O to continue until some command is issued that positions
        the tape to a known position. Typically you must rewind the
        tape (by issuing <span class="emphasis"><em>mt -f /dev/st0
        rewind</em></span> for example) before I/O can proceed
        again to a tape drive that was reset.</p>
      </div>
    </div>

    <div class="refsect1">
      <a id="cciss-4_sect12" name="cciss-4_sect12" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p><span class="citerefentry"><span class="refentrytitle">cciss_vol_status</span>(8)</span>, <a class="link" href="../htmlman4/hpsa.4.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">hpsa</span>(4)</span></a>, <span class="citerefentry"><span class="refentrytitle">hpacucli</span>(8)</span>, <span class="citerefentry"><span class="refentrytitle">hpacuxe</span>(8)</span>,</p>

      <p><a class="literalurl" href="http://cciss.sf.net" target="_top" shape="rect">http://cciss.sf.net</a> and <code class="filename">Documentation/blockdev/cciss.txt</code> and
      <code class="filename">Documentation/ABI/testing/sysfs-bus-pci-devices-cciss</code>
      in the Linux kernel source tree</p>
    </div>

    <div class="colophon">
      <a id="cciss-4_sect13" name="cciss-4_sect13" shape="rect"> </a>

      <h2>COLOPHON</h2>

      <p>This page is part of release 3.72 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      http://www.kernel.org/doc/man−pages/.</p>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (C) 2011, Hewlett-Packard Development Company, L.P.<br />

                  Written by Stephen M. Cameron &lt;scameron<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>beardog.cce.hp.com&gt;<br />

                  <br />
                  %%%LICENSE_START(GPLv2_ONELINE)<br />
                  Licensed under GNU General Public License version 2 (GPLv2)<br />

                  %%%LICENSE_END<br />
                  <br />
                  shorthand for double quote that works everywhere.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
